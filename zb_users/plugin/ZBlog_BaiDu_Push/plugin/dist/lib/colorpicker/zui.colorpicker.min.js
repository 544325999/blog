/*!
 * ZUI: 颜色选择器 - v1.7.0 - 2017-06-17
 * http://zui.sexy
 * GitHub: https://github.com/easysoft/zui.git 
 * Copyright (c) 2017 cnezsoft.com; Licensed MIT
 */
!function(eEaIbLaGgG){"use strict";var aNdRbKhbaK="zui.colorPicker",gGdBbJacgW='<div class="colorpicker"><button type="button" class="btn dropdown-toggle" data-toggle="dropdown"><span class="cp-title"></span><i class="ic"></i></button><ul class="dropdown-menu clearfix"></ul></div>',abdTaMeggD={zh_cn:{errorTip:"不是有效的颜色值"},zh_tw:{errorTip:"不是有效的顏色值"},en:{errorTip:"Not a valid color value"}},eibVdXahgK=function(gGdBbJacgW,abdTaMeggD){this.name=aNdRbKhbaK,this.$=eEaIbLaGgG(gGdBbJacgW),this.getOptions(abdTaMeggD),this.init()};eibVdXahgK.DEFAULTS={colors:["#00BCD4","#388E3C","#3280fc","#3F51B5","#9C27B0","#795548","#F57C00","#F44336","#E91E63"],pullMenuRight:!0,wrapper:"btn-wrapper",tileSize:30,lineCount:5,optional:!0,tooltip:"top",icon:"caret-down"},eibVdXahgK.prototype.init=function(){var aNdRbKhbaK=this.options,abdTaMeggD=this;this.$picker=eEaIbLaGgG(gGdBbJacgW).addClass(aNdRbKhbaK.wrapper),this.$picker.find(".cp-title").toggle(void 0!==aNdRbKhbaK.title).text(aNdRbKhbaK.title),this.$menu=this.$picker.find(".dropdown-menu").toggleClass("pull-right",aNdRbKhbaK.pullMenuRight),this.$btn=this.$picker.find(".btn.dropdown-toggle"),this.$btn.find(".ic").addClass("icon-"+aNdRbKhbaK.icon),aNdRbKhbaK.btnTip&&this.$picker.attr("data-toggle","tooltip").tooltip({title:aNdRbKhbaK.btnTip,placement:aNdRbKhbaK.tooltip,container:"body"}),this.$.attr("data-provide",null).after(this.$picker),this.colors={},eEaIbLaGgG.each(this.options.colors,function(aNdRbKhbaK,gGdBbJacgW){if(eEaIbLaGgG.zui.Color.isColor(gGdBbJacgW)){var eibVdXahgK=new eEaIbLaGgG.zui.Color(gGdBbJacgW);abdTaMeggD.colors[eibVdXahgK.toCssStr()]=eibVdXahgK}}),this.updateColors();var abdTaMeggD=this;this.$picker.on("click",".cp-tile",function(){abdTaMeggD.setValue(eEaIbLaGgG(this).data("color"))});var eibVdXahgK=this.$,aGbafIeF=function(){var gGdBbJacgW=eibVdXahgK.val(),aGbafIeF=eEaIbLaGgG.zui.Color.isColor(gGdBbJacgW);eibVdXahgK.parent().toggleClass("has-error",!(aGbafIeF||aNdRbKhbaK.optional&&""===gGdBbJacgW)),aGbafIeF?abdTaMeggD.setValue(gGdBbJacgW,!0):aNdRbKhbaK.optional&&""===gGdBbJacgW?eibVdXahgK.tooltip("hide"):eibVdXahgK.is(":focus")||eibVdXahgK.tooltip("show",aNdRbKhbaK.errorTip)};eibVdXahgK.is("input:not([type=hidden])")?(aNdRbKhbaK.tooltip&&eibVdXahgK.attr("data-toggle","tooltip").tooltip({trigger:"manual",placement:aNdRbKhbaK.tooltip,tipClass:"tooltip-danger",container:"body"}),eibVdXahgK.on("keyup paste input change",aGbafIeF)):eibVdXahgK.appendTo(this.$picker),aGbafIeF()},eibVdXahgK.prototype.addColor=function(aNdRbKhbaK){aNdRbKhbaK instanceof eEaIbLaGgG.zui.Color||(aNdRbKhbaK=new eEaIbLaGgG.zui.Color(aNdRbKhbaK));var gGdBbJacgW=aNdRbKhbaK.toCssStr(),abdTaMeggD=this.options;this.colors[gGdBbJacgW]||(this.colors[gGdBbJacgW]=aNdRbKhbaK);var eibVdXahgK=eEaIbLaGgG('<a href="###" class="cp-tile"></a>',{titile:aNdRbKhbaK}).data("color",aNdRbKhbaK).css({color:aNdRbKhbaK.contrast().toCssStr(),background:gGdBbJacgW,"border-color":aNdRbKhbaK.luma()>.43?"#ccc":"transparent"}).attr("data-color",gGdBbJacgW);this.$menu.append(eEaIbLaGgG("<li/>").css({width:abdTaMeggD.tileSize,height:abdTaMeggD.tileSize}).append(eibVdXahgK)),abdTaMeggD.optional&&this.$menu.find(".cp-tile.empty").parent().detach().appendTo(this.$menu)},eibVdXahgK.prototype.updateColors=function(aNdRbKhbaK){var gGdBbJacgW=(this.$picker,this.$menu.empty()),abdTaMeggD=this.options,aNdRbKhbaK=aNdRbKhbaK||this.colors,eibVdXahgK=this,aGbafIeF=0;if(eEaIbLaGgG.each(aNdRbKhbaK,function(eEaIbLaGgG,aNdRbKhbaK){eibVdXahgK.addColor(aNdRbKhbaK),aGbafIeF++}),abdTaMeggD.optional){var eEaIbLaGgGeEaIbLaGgG=eEaIbLaGgG('<li><a class="cp-tile empty" href="###"></a></li>').css({width:abdTaMeggD.tileSize,height:abdTaMeggD.tileSize});this.$menu.append(eEaIbLaGgGeEaIbLaGgG),aGbafIeF++}gGdBbJacgW.css("width",Math.min(aGbafIeF,abdTaMeggD.lineCount)*abdTaMeggD.tileSize+6)},eibVdXahgK.prototype.setValue=function(aNdRbKhbaK,gGdBbJacgW){var abdTaMeggD=this.options;this.$menu.find(".cp-tile.active").removeClass("active");var eibVdXahgK="";if(aNdRbKhbaK){var aGbafIeF=new eEaIbLaGgG.zui.Color(aNdRbKhbaK);eibVdXahgK=aGbafIeF.toCssStr().toLowerCase(),this.$btn.css({background:eibVdXahgK,color:aGbafIeF.contrast().toCssStr(),borderColor:aGbafIeF.luma()>.43?"#ccc":eibVdXahgK}),this.colors[eibVdXahgK]||this.addColor(aGbafIeF),gGdBbJacgW||this.$.val().toLowerCase()===eibVdXahgK||this.$.val(eibVdXahgK).trigger("change"),this.$menu.find('.cp-tile[data-color="'+eibVdXahgK+'"]').addClass("active"),this.$.tooltip("hide"),this.$.trigger("colorchange",aGbafIeF)}else this.$btn.attr("style",null),gGdBbJacgW||""===this.$.val()||this.$.val(eibVdXahgK).trigger("change"),abdTaMeggD.optional&&this.$.tooltip("hide"),this.$menu.find(".cp-tile.empty").addClass("active"),this.$.trigger("colorchange",null);abdTaMeggD.updateBorder&&eEaIbLaGgG(abdTaMeggD.updateBorder).css("border-color",eibVdXahgK),abdTaMeggD.updateBackground&&eEaIbLaGgG(abdTaMeggD.updateBackground).css("background-color",eibVdXahgK),abdTaMeggD.updateColor&&eEaIbLaGgG(abdTaMeggD.updateText).css("color",eibVdXahgK),abdTaMeggD.updateText&&eEaIbLaGgG(abdTaMeggD.updateText).text(eibVdXahgK)},eibVdXahgK.prototype.getOptions=function(aNdRbKhbaK){var gGdBbJacgW=eEaIbLaGgG.extend({},eibVdXahgK.DEFAULTS,this.$.data(),aNdRbKhbaK);"string"==typeof gGdBbJacgW.colors&&(gGdBbJacgW.colors=gGdBbJacgW.colors.split(","));var aGbafIeF=(gGdBbJacgW.lang||eEaIbLaGgG.zui.clientLang()).toLowerCase();gGdBbJacgW.errorTip||(gGdBbJacgW.errorTip=abdTaMeggD[aGbafIeF].errorTip),eEaIbLaGgG.fn.tooltip||(gGdBbJacgW.btnTip=!1),this.options=gGdBbJacgW},eEaIbLaGgG.fn.colorPicker=function(gGdBbJacgW){return this.each(function(){var abdTaMeggD=eEaIbLaGgG(this),aGbafIeF=abdTaMeggD.data(aNdRbKhbaK),eEaIbLaGgGeEaIbLaGgG="object"==typeof gGdBbJacgW&&gGdBbJacgW;aGbafIeF||abdTaMeggD.data(aNdRbKhbaK,aGbafIeF=new eibVdXahgK(this,eEaIbLaGgGeEaIbLaGgG)),"string"==typeof gGdBbJacgW&&aGbafIeF[gGdBbJacgW]()})},eEaIbLaGgG.fn.colorPicker.Constructor=eibVdXahgK,eEaIbLaGgG(function(){eEaIbLaGgG('[data-provide="colorpicker"]').colorPicker()})}(jQuery);
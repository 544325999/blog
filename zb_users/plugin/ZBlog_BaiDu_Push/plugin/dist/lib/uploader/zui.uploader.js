/*!
 * ZUI: 文件上传 - v1.7.0 - 2017-06-17
 * http://zui.sexy
 * GitHub: https://github.com/easysoft/zui.git 
 * Copyright (c) 2017 cnezsoft.com; Licensed MIT
 */
/*!
 * mOxie - multi-runtime File API & XMLHttpRequest L2 Polyfill
 * v1.5.2
 *
 * Copyright 2013, Moxiecode Systems AB
 * Released under GPL License.
 *
 * License: http://www.plupload.com/license
 * Contributing: http://www.plupload.com/contributing
 *
 * Date: 2016-11-23
 */
!function(b,J){var e=function(){var b={};return J.apply(b,arguments),b.moxie};"function"==typeof define&&define.amd?define("moxie",[],e):"object"==typeof module&&module.exports?module.exports=e():b.moxie=e()}(this||window,function(){!function(b,J){"use strict";function e(b,J){for(var e,Q=[],ed=0;ed<b.length;++ed){if(e=bc[b[ed]]||g(b[ed]),!e)throw"module definition dependecy not found: "+b[ed];Q.push(e)}J.apply(null,Q)}function Q(b,Q,ed){if("string"!=typeof b)throw"invalid module definition, module id must be defined and be a string";if(Q===J)throw"invalid module definition, dependencies must be specified";if(ed===J)throw"invalid module definition, definition function must be specified";e(Q,function(){bc[b]=ed.apply(null,arguments)})}function ed(b){return!!bc[b]}function g(J){for(var e=b,Q=J.split(/[.\/]/),ed=0;ed<Q.length;++ed){if(!e[Q[ed]])return;e=e[Q[ed]]}return e}function Qc(e){for(var Q=0;Q<e.length;Q++){for(var ed=b,g=e[Q],Qc=g.split(/[.\/]/),A=0;A<Qc.length-1;++A)ed[Qc[A]]===J&&(ed[Qc[A]]={}),ed=ed[Qc[A]];ed[Qc[Qc.length-1]]=bc[g]}}var bc={};Q("moxie/core/utils/Basic",[],function(){function b(b){var J;return b===J?"undefined":null===b?"null":b.nodeType?"node":{}.toString.call(b).match(/\s([a-z|A-Z]+)/)[1].toLowerCase()}function J(){return Qc(!1,!1,arguments)}function e(){return Qc(!0,!1,arguments)}function Q(){return Qc(!1,!0,arguments)}function ed(){return Qc(!0,!0,arguments)}function g(e){switch(b(e)){case"array":return Array.prototype.slice.call(e);case"object":return J({},e)}return e}function Qc(J,e,Q){var ed,bc=Q[0];return A(Q,function(Q,d){d>0&&A(Q,function(Q,A){var d=-1!==bI(b(Q),["array","object"]);return Q===ed||J&&bc[A]===ed?!0:(d&&e&&(Q=g(Q)),b(bc[A])===b(Q)&&d?Qc(J,e,[bc[A],Q]):bc[A]=Q,void 0)})}),bc}function bc(b,J){function e(){this.constructor=b}for(var Q in J)({}).hasOwnProperty.call(J,Q)&&(b[Q]=J[Q]);return e.prototype=J.prototype,b.prototype=new e,b.__parent__=J.prototype,b}function A(b,J){var e,Q,ed,g;if(b){try{e=b.length}catch(b){e=g}if(e===g||"number"!=typeof e){for(Q in b)if(b.hasOwnProperty(Q)&&J(b[Q],Q)===!1)return}else for(ed=0;e>ed;ed++)if(J(b[ed],ed)===!1)return}}function d(J){var e;if(!J||"object"!==b(J))return!0;for(e in J)return!1;return!0}function U(J,e){function Q(ed){"function"===b(J[ed])&&J[ed](function(b){++ed<g&&!b?Q(ed):e(b)})}var ed=0,g=J.length;"function"!==b(e)&&(e=function(){}),J&&J.length||e(),Q(ed)}function bV(b,J){var e=0,Q=b.length,ed=new Array(Q);A(b,function(b,g){b(function(b){if(b)return J(b);var Qc=[].slice.call(arguments);Qc.shift(),ed[g]=Qc,e++,e===Q&&(ed.unshift(null),J.apply(this,ed))})})}function bI(b,J){if(J){if(Array.prototype.indexOf)return Array.prototype.indexOf.call(J,b);for(var e=0,Q=J.length;Q>e;e++)if(J[e]===b)return e}return-1}function a(J,e){var Q=[];"array"!==b(J)&&(J=[J]),"array"!==b(e)&&(e=[e]);for(var ed in J)-1===bI(J[ed],e)&&Q.push(J[ed]);return Q.length?Q:!1}function h(b,J){var e=[];return A(b,function(b){-1!==bI(b,J)&&e.push(b)}),e.length?e:null}function c(b){var J,e=[];for(J=0;J<b.length;J++)e[J]=b[J];return e}function N(b){return b?String.prototype.trim?String.prototype.trim.call(b):b.toString().replace(/^\s*/,"").replace(/\s*$/,""):b}function bb(b){if("string"!=typeof b)return b;var J,e={t:1099511627776,g:1073741824,m:1048576,k:1024};return b=/^([0-9\.]+)([tmgk]?)$/.exec(b.toLowerCase().replace(/[^0-9\.tmkg]/g,"")),J=b[2],b=+b[1],e.hasOwnProperty(J)&&(b*=e[J]),Math.floor(b)}function ee(J){var e=[].slice.call(arguments,1);return J.replace(/%[a-z]/g,function(){var J=e.shift();return"undefined"!==b(J)?J:""})}function de(b,J){var e=this;setTimeout(function(){b.call(e)},J||1)}var gS=function(){var b=0;return function(J){var e,Q=(new Date).getTime().toString(32);for(e=0;5>e;e++)Q+=Math.floor(65535*Math.random()).toString(32);return(J||"o_")+Q+(b++).toString(32)}}();return{guid:gS,typeOf:b,extend:J,extendIf:e,extendImmutable:Q,extendImmutableIf:ed,inherit:bc,each:A,isEmptyObj:d,inSeries:U,inParallel:bV,inArray:bI,arrayDiff:a,arrayIntersect:h,toArray:c,trim:N,sprintf:ee,parseSizeStr:bb,delay:de}}),Q("moxie/core/utils/Encode",[],function(){var b=function(b){return unescape(encodeURIComponent(b))},J=function(b){return decodeURIComponent(escape(b))},e=function(b,e){if("function"==typeof window.atob)return e?J(window.atob(b)):window.atob(b);var Q,ed,g,Qc,bc,A,d,U,bV="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bI=0,a=0,h="",c=[];if(!b)return b;b+="";do{Qc=bV.indexOf(b.charAt(bI++)),bc=bV.indexOf(b.charAt(bI++)),A=bV.indexOf(b.charAt(bI++)),d=bV.indexOf(b.charAt(bI++)),U=Qc<<18|bc<<12|A<<6|d,Q=255&U>>16,ed=255&U>>8,g=255&U,c[a++]=64==A?String.fromCharCode(Q):64==d?String.fromCharCode(Q,ed):String.fromCharCode(Q,ed,g)}while(bI<b.length);return h=c.join(""),e?J(h):h},Q=function(J,e){if(e&&(J=b(J)),"function"==typeof window.btoa)return window.btoa(J);var Q,ed,g,Qc,bc,A,d,U,bV="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bI=0,a=0,h="",c=[];if(!J)return J;do{Q=J.charCodeAt(bI++),ed=J.charCodeAt(bI++),g=J.charCodeAt(bI++),U=Q<<16|ed<<8|g,Qc=63&U>>18,bc=63&U>>12,A=63&U>>6,d=63&U,c[a++]=bV.charAt(Qc)+bV.charAt(bc)+bV.charAt(A)+bV.charAt(d)}while(bI<J.length);h=c.join("");var N=J.length%3;return(N?h.slice(0,N-3):h)+"===".slice(N||3)};return{utf8_encode:b,utf8_decode:J,atob:e,btoa:Q}}),Q("moxie/core/utils/Env",["moxie/core/utils/Basic"],function(b){function J(b,J,e){var Q=0,ed=0,g=0,Qc={dev:-6,alpha:-5,a:-5,beta:-4,b:-4,RC:-3,rc:-3,"#":-2,p:1,pl:1},bc=function(b){return b=(""+b).replace(/[_\-+]/g,"."),b=b.replace(/([^.\d]+)/g,".$1.").replace(/\.{2,}/g,"."),b.length?b.split("."):[-8]},A=function(b){return b?isNaN(b)?Qc[b]||-7:parseInt(b,10):0};for(b=bc(b),J=bc(J),ed=Math.max(b.length,J.length),Q=0;ed>Q;Q++)if(b[Q]!=J[Q]){if(b[Q]=A(b[Q]),J[Q]=A(J[Q]),b[Q]<J[Q]){g=-1;break}if(b[Q]>J[Q]){g=1;break}}if(!e)return g;switch(e){case">":case"gt":return g>0;case">=":case"ge":return g>=0;case"<=":case"le":return 0>=g;case"==":case"=":case"eq":return 0===g;case"<>":case"!=":case"ne":return 0!==g;case"":case"<":case"lt":return 0>g;default:return null}}var e=function(b){var J="",e="?",Q="function",ed="undefined",g="object",Qc="name",bc="version",A={has:function(b,J){return-1!==J.toLowerCase().indexOf(b.toLowerCase())},lowerize:function(b){return b.toLowerCase()}},d={rgx:function(){for(var J,e,Qc,bc,A,d,U,bV=0,bI=arguments;bV<bI.length;bV+=2){var a=bI[bV],h=bI[bV+1];if(typeof J===ed){J={};for(bc in h)A=h[bc],typeof A===g?J[A[0]]=b:J[A]=b}for(e=Qc=0;e<a.length;e++)if(d=a[e].exec(this.getUA())){for(bc=0;bc<h.length;bc++)U=d[++Qc],A=h[bc],typeof A===g&&A.length>0?2==A.length?J[A[0]]=typeof A[1]==Q?A[1].call(this,U):A[1]:3==A.length?J[A[0]]=typeof A[1]!==Q||A[1].exec&&A[1].test?U?U.replace(A[1],A[2]):b:U?A[1].call(this,U,A[2]):b:4==A.length&&(J[A[0]]=U?A[3].call(this,U.replace(A[1],A[2])):b):J[A]=U?U:b;break}if(d)break}return J},str:function(J,Q){for(var ed in Q)if(typeof Q[ed]===g&&Q[ed].length>0){for(var Qc=0;Qc<Q[ed].length;Qc++)if(A.has(Q[ed][Qc],J))return ed===e?b:ed}else if(A.has(Q[ed],J))return ed===e?b:ed;return J}},U={browser:{oldsafari:{major:{1:["/8","/1","/3"],2:"/4","?":"/"},version:{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}}},device:{sprint:{model:{"Evo Shift 4G":"7373KT"},vendor:{HTC:"APA",Sprint:"Sprint"}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",RT:"ARM"}}}},bV={browser:[[/(opera\smini)\/([\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/([\w\.-]+)/i,/(opera).+version\/([\w\.]+)/i,/(opera)[\/\s]+([\w\.]+)/i],[Qc,bc],[/\s(opr)\/([\w\.]+)/i],[[Qc,"Opera"],bc],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]+)*/i,/(avant\s|iemobile|slim|baidu)(?:browser)?[\/\s]?([\w\.]*)/i,/(?:ms|\()(ie)\s([\w\.]+)/i,/(rekonq)\/([\w\.]+)*/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi)\/([\w\.-]+)/i],[Qc,bc],[/(trident).+rv[:\s]([\w\.]+).+like\sgecko/i],[[Qc,"IE"],bc],[/(edge)\/((\d+)?[\w\.]+)/i],[Qc,bc],[/(yabrowser)\/([\w\.]+)/i],[[Qc,"Yandex"],bc],[/(comodo_dragon)\/([\w\.]+)/i],[[Qc,/_/g," "],bc],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i,/(uc\s?browser|qqbrowser)[\/\s]?([\w\.]+)/i],[Qc,bc],[/(dolfin)\/([\w\.]+)/i],[[Qc,"Dolphin"],bc],[/((?:android.+)crmo|crios)\/([\w\.]+)/i],[[Qc,"Chrome"],bc],[/XiaoMi\/MiuiBrowser\/([\w\.]+)/i],[bc,[Qc,"MIUI Browser"]],[/android.+version\/([\w\.]+)\s+(?:mobile\s?safari|safari)/i],[bc,[Qc,"Android Browser"]],[/FBAV\/([\w\.]+);/i],[bc,[Qc,"Facebook"]],[/version\/([\w\.]+).+?mobile\/\w+\s(safari)/i],[bc,[Qc,"Mobile Safari"]],[/version\/([\w\.]+).+?(mobile\s?safari|safari)/i],[bc,Qc],[/webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[Qc,[bc,d.str,U.browser.oldsafari.version]],[/(konqueror)\/([\w\.]+)/i,/(webkit|khtml)\/([\w\.]+)/i],[Qc,bc],[/(navigator|netscape)\/([\w\.-]+)/i],[[Qc,"Netscape"],bc],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix)\/([\w\.-]+)/i,/(mozilla)\/([\w\.]+).+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf)[\/\s]?([\w\.]+)/i,/(links)\s\(([\w\.]+)/i,/(gobrowser)\/?([\w\.]+)*/i,/(ice\s?browser)\/v?([\w\._]+)/i,/(mosaic)[\/\s]([\w\.]+)/i],[Qc,bc]],engine:[[/windows.+\sedge\/([\w\.]+)/i],[bc,[Qc,"EdgeHTML"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[Qc,bc],[/rv\:([\w\.]+).*(gecko)/i],[bc,Qc]],os:[[/microsoft\s(windows)\s(vista|xp)/i],[Qc,bc],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*|windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],[Qc,[bc,d.str,U.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[Qc,"Windows"],[bc,d.str,U.os.windows.version]],[/\((bb)(10);/i],[[Qc,"BlackBerry"],bc],[/(blackberry)\w*\/?([\w\.]+)*/i,/(tizen)[\/\s]([\w\.]+)/i,/(android|webos|palm\os|qnx|bada|rim\stablet\sos|meego|contiki)[\/\s-]?([\w\.]+)*/i,/linux;.+(sailfish);/i],[Qc,bc],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]+)*/i],[[Qc,"Symbian"],bc],[/\((series40);/i],[Qc],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[Qc,"Firefox OS"],bc],[/(nintendo|playstation)\s([wids3portablevu]+)/i,/(mint)[\/\s\(]?(\w+)*/i,/(mageia|vectorlinux)[;\s]/i,/(joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus)[\/\s-]?([\w\.-]+)*/i,/(hurd|linux)\s?([\w\.]+)*/i,/(gnu)\s?([\w\.]+)*/i],[Qc,bc],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[Qc,"Chromium OS"],bc],[/(sunos)\s?([\w\.]+\d)*/i],[[Qc,"Solaris"],bc],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]+)*/i],[Qc,bc],[/(ip[honead]+)(?:.*os\s*([\w]+)*\slike\smac|;\sopera)/i],[[Qc,"iOS"],[bc,/_/g,"."]],[/(mac\sos\sx)\s?([\w\s\.]+\w)*/i,/(macintosh|mac(?=_powerpc)\s)/i],[[Qc,"Mac OS"],[bc,/_/g,"."]],[/((?:open)?solaris)[\/\s-]?([\w\.]+)*/i,/(haiku)\s(\w+)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.]*)*/i,/(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms)/i,/(unix)\s?([\w\.]+)*/i],[Qc,bc]]},bI=function(b){var e=b||(window&&window.navigator&&window.navigator.userAgent?window.navigator.userAgent:J);this.getBrowser=function(){return d.rgx.apply(this,bV.browser)},this.getEngine=function(){return d.rgx.apply(this,bV.engine)},this.getOS=function(){return d.rgx.apply(this,bV.os)},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS()}},this.getUA=function(){return e},this.setUA=function(b){return e=b,this},this.setUA(e)};return bI}(),Q=function(){var J={define_property:function(){return!1}(),create_canvas:function(){var b=document.createElement("canvas");return!(!b.getContext||!b.getContext("2d"))}(),return_response_type:function(J){try{if(-1!==b.inArray(J,["","text","document"]))return!0;if(window.XMLHttpRequest){var e=new XMLHttpRequest;if(e.open("get","/"),"responseType"in e)return e.responseType=J,e.responseType!==J?!1:!0}}catch(b){}return!1},use_data_uri:function(){var b=new Image;return b.onload=function(){J.use_data_uri=1===b.width&&1===b.height},setTimeout(function(){b.src="data:image/gif;base64,R0lGODlhAQABAIAAAP8AAAAAACH5BAAAAAAALAAAAAABAAEAAAICRAEAOw=="},1),!1}(),use_data_uri_over32kb:function(){return J.use_data_uri&&("IE"!==g.browser||g.version>=9)},use_data_uri_of:function(b){return J.use_data_uri&&33e3>b||J.use_data_uri_over32kb()},use_fileinput:function(){if(navigator.userAgent.match(/(Android (1.0|1.1|1.5|1.6|2.0|2.1))|(Windows Phone (OS 7|8.0))|(XBLWP)|(ZuneWP)|(w(eb)?OSBrowser)|(webOS)|(Kindle\/(1.0|2.0|2.5|3.0))/))return!1;var b=document.createElement("input");return b.setAttribute("type","file"),!b.disabled}};return function(e){var Q=[].slice.call(arguments);return Q.shift(),"function"===b.typeOf(J[e])?J[e].apply(this,Q):!!J[e]}}(),ed=(new e).getResult(),g={can:Q,uaParser:e,browser:ed.browser.name,version:ed.browser.version,os:ed.os.name,osVersion:ed.os.version,verComp:J,swf_url:"../flash/Moxie.swf",xap_url:"../silverlight/Moxie.xap",global_event_dispatcher:"moxie.core.EventTarget.instance.dispatchEvent"};return g.OS=g.os,g}),Q("moxie/core/Exceptions",["moxie/core/utils/Basic"],function(b){function J(b,J){var e;for(e in b)if(b[e]===J)return e;return null}return{RuntimeError:function(){function e(b,e){this.code=b,this.name=J(Q,b),this.message=this.name+(e||": RuntimeError "+this.code)}var Q={NOT_INIT_ERR:1,EXCEPTION_ERR:3,NOT_SUPPORTED_ERR:9,JS_ERR:4};return b.extend(e,Q),e.prototype=Error.prototype,e}(),OperationNotAllowedException:function(){function J(b){this.code=b,this.name="OperationNotAllowedException"}return b.extend(J,{NOT_ALLOWED_ERR:1}),J.prototype=Error.prototype,J}(),ImageError:function(){function e(b){this.code=b,this.name=J(Q,b),this.message=this.name+": ImageError "+this.code}var Q={WRONG_FORMAT:1,MAX_RESOLUTION_ERR:2,INVALID_META_ERR:3};return b.extend(e,Q),e.prototype=Error.prototype,e}(),FileException:function(){function e(b){this.code=b,this.name=J(Q,b),this.message=this.name+": FileException "+this.code}var Q={NOT_FOUND_ERR:1,SECURITY_ERR:2,ABORT_ERR:3,NOT_READABLE_ERR:4,ENCODING_ERR:5,NO_MODIFICATION_ALLOWED_ERR:6,INVALID_STATE_ERR:7,SYNTAX_ERR:8};return b.extend(e,Q),e.prototype=Error.prototype,e}(),DOMException:function(){function e(b){this.code=b,this.name=J(Q,b),this.message=this.name+": DOMException "+this.code}var Q={INDEX_SIZE_ERR:1,DOMSTRING_SIZE_ERR:2,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,INVALID_CHARACTER_ERR:5,NO_DATA_ALLOWED_ERR:6,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INUSE_ATTRIBUTE_ERR:10,INVALID_STATE_ERR:11,SYNTAX_ERR:12,INVALID_MODIFICATION_ERR:13,NAMESPACE_ERR:14,INVALID_ACCESS_ERR:15,VALIDATION_ERR:16,TYPE_MISMATCH_ERR:17,SECURITY_ERR:18,NETWORK_ERR:19,ABORT_ERR:20,URL_MISMATCH_ERR:21,QUOTA_EXCEEDED_ERR:22,TIMEOUT_ERR:23,INVALID_NODE_TYPE_ERR:24,DATA_CLONE_ERR:25};return b.extend(e,Q),e.prototype=Error.prototype,e}(),EventException:function(){function J(b){this.code=b,this.name="EventException"}return b.extend(J,{UNSPECIFIED_EVENT_TYPE_ERR:0}),J.prototype=Error.prototype,J}()}}),Q("moxie/core/utils/Dom",["moxie/core/utils/Env"],function(b){var J=function(b){return"string"!=typeof b?b:document.getElementById(b)},e=function(b,J){if(!b.className)return!1;var e=new RegExp("(^|\\s+)"+J+"(\\s+|$)");return e.test(b.className)},Q=function(b,J){e(b,J)||(b.className=b.className?b.className.replace(/\s+$/,"")+" "+J:J)},ed=function(b,J){if(b.className){var e=new RegExp("(^|\\s+)"+J+"(\\s+|$)");b.className=b.className.replace(e,function(b,J,e){return" "===J&&" "===e?" ":""})}},g=function(b,J){return b.currentStyle?b.currentStyle[J]:window.getComputedStyle?window.getComputedStyle(b,null)[J]:void 0},Qc=function(J,e){function Q(b){var J,e,Q=0,ed=0;return b&&(e=b.getBoundingClientRect(),J="CSS1Compat"===d.compatMode?d.documentElement:d.body,Q=e.left+J.scrollLeft,ed=e.top+J.scrollTop),{x:Q,y:ed}}var ed,g,Qc,bc=0,A=0,d=document;if(J=J,e=e||d.body,J&&J.getBoundingClientRect&&"IE"===b.browser&&(!d.documentMode||d.documentMode<8))return g=Q(J),Qc=Q(e),{x:g.x-Qc.x,y:g.y-Qc.y};for(ed=J;ed&&ed!=e&&ed.nodeType;)bc+=ed.offsetLeft||0,A+=ed.offsetTop||0,ed=ed.offsetParent;for(ed=J.parentNode;ed&&ed!=e&&ed.nodeType;)bc-=ed.scrollLeft||0,A-=ed.scrollTop||0,ed=ed.parentNode;return{x:bc,y:A}},bc=function(b){return{w:b.offsetWidth||b.clientWidth,h:b.offsetHeight||b.clientHeight}};return{get:J,hasClass:e,addClass:Q,removeClass:ed,getStyle:g,getPos:Qc,getSize:bc}}),Q("moxie/core/EventTarget",["moxie/core/utils/Env","moxie/core/Exceptions","moxie/core/utils/Basic"],function(b,J,e){function Q(){this.uid=e.guid()}var ed={};return e.extend(Q.prototype,{init:function(){this.uid||(this.uid=e.guid("uid_"))},addEventListener:function(b,J,Q,g){var Qc,bc=this;return this.hasOwnProperty("uid")||(this.uid=e.guid("uid_")),b=e.trim(b),/\s/.test(b)?(e.each(b.split(/\s+/),function(b){bc.addEventListener(b,J,Q,g)}),void 0):(b=b.toLowerCase(),Q=parseInt(Q,10)||0,Qc=ed[this.uid]&&ed[this.uid][b]||[],Qc.push({fn:J,priority:Q,scope:g||this}),ed[this.uid]||(ed[this.uid]={}),ed[this.uid][b]=Qc,void 0)},hasEventListener:function(b){var J;return b?(b=b.toLowerCase(),J=ed[this.uid]&&ed[this.uid][b]):J=ed[this.uid],J?J:!1},removeEventListener:function(b,J){var Q,g,Qc=this;if(b=b.toLowerCase(),/\s/.test(b))return e.each(b.split(/\s+/),function(b){Qc.removeEventListener(b,J)}),void 0;if(Q=ed[this.uid]&&ed[this.uid][b]){if(J){for(g=Q.length-1;g>=0;g--)if(Q[g].fn===J){Q.splice(g,1);break}}else Q=[];Q.length||(delete ed[this.uid][b],e.isEmptyObj(ed[this.uid])&&delete ed[this.uid])}},removeAllEventListeners:function(){ed[this.uid]&&delete ed[this.uid]},dispatchEvent:function(b){var Q,g,Qc,bc,A,d={},U=!0;if("string"!==e.typeOf(b)){if(bc=b,"string"!==e.typeOf(bc.type))throw new J.EventException(J.EventException.UNSPECIFIED_EVENT_TYPE_ERR);b=bc.type,bc.total!==A&&bc.loaded!==A&&(d.total=bc.total,d.loaded=bc.loaded),d.async=bc.async||!1}if(-1!==b.indexOf("::")?function(J){Q=J[0],b=J[1]}(b.split("::")):Q=this.uid,b=b.toLowerCase(),g=ed[Q]&&ed[Q][b]){g.sort(function(b,J){return J.priority-b.priority}),Qc=[].slice.call(arguments),Qc.shift(),d.type=b,Qc.unshift(d);var bV=[];e.each(g,function(b){Qc[0].target=b.scope,d.async?bV.push(function(J){setTimeout(function(){J(b.fn.apply(b.scope,Qc)===!1)},1)}):bV.push(function(J){J(b.fn.apply(b.scope,Qc)===!1)})}),bV.length&&e.inSeries(bV,function(b){U=!b})}return U},bindOnce:function(b,J,e,Q){var ed=this;ed.bind.call(this,b,function e(){return ed.unbind(b,e),J.apply(this,arguments)},e,Q)},bind:function(){this.addEventListener.apply(this,arguments)},unbind:function(){this.removeEventListener.apply(this,arguments)},unbindAll:function(){this.removeAllEventListeners.apply(this,arguments)},trigger:function(){return this.dispatchEvent.apply(this,arguments)},handleEventProps:function(b){var J=this;this.bind(b.join(" "),function(b){var J="on"+b.type.toLowerCase();"function"===e.typeOf(this[J])&&this[J].apply(this,arguments)}),e.each(b,function(b){b="on"+b.toLowerCase(b),"undefined"===e.typeOf(J[b])&&(J[b]=null)})}}),Q.instance=new Q,Q}),Q("moxie/runtime/Runtime",["moxie/core/utils/Env","moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/EventTarget"],function(b,J,e,Q){function ed(b,Q,g,bc,A){var d,U=this,bV=J.guid(Q+"_"),bI=A||"browser";b=b||{},Qc[bV]=this,g=J.extend({access_binary:!1,access_image_binary:!1,display_media:!1,do_cors:!1,drag_and_drop:!1,filter_by_extension:!0,resize_image:!1,report_upload_progress:!1,return_response_headers:!1,return_response_type:!1,return_status_code:!0,send_custom_headers:!1,select_file:!1,select_folder:!1,select_multiple:!0,send_binary_string:!1,send_browser_cookies:!0,send_multipart:!0,slice_blob:!1,stream_upload:!1,summon_file_dialog:!1,upload_filesize:!0,use_http_method:!0},g),b.preferred_caps&&(bI=ed.getMode(bc,b.preferred_caps,bI)),d=function(){var b={};return{exec:function(J,e,Q,ed){return d[e]&&(b[J]||(b[J]={context:this,instance:new d[e]}),b[J].instance[Q])?b[J].instance[Q].apply(this,ed):void 0},removeInstance:function(J){delete b[J]},removeAllInstances:function(){var e=this;J.each(b,function(b,Q){"function"===J.typeOf(b.instance.destroy)&&b.instance.destroy.call(b.context),e.removeInstance(Q)})}}}(),J.extend(this,{initialized:!1,uid:bV,type:Q,mode:ed.getMode(bc,b.required_caps,bI),shimid:bV+"_container",clients:0,options:b,can:function(b,e){var Q=arguments[2]||g;if("string"===J.typeOf(b)&&"undefined"===J.typeOf(e)&&(b=ed.parseCaps(b)),"object"===J.typeOf(b)){for(var Qc in b)if(!this.can(Qc,b[Qc],Q))return!1;return!0}return"function"===J.typeOf(Q[b])?Q[b].call(this,e):e===Q[b]},getShimContainer:function(){var b,Q=e.get(this.shimid);return Q||(b=e.get(this.options.container)||document.body,Q=document.createElement("div"),Q.id=this.shimid,Q.className="moxie-shim moxie-shim-"+this.type,J.extend(Q.style,{position:"absolute",top:"0px",left:"0px",width:"1px",height:"1px",overflow:"hidden"}),b.appendChild(Q),b=null),Q},getShim:function(){return d},shimExec:function(b,J){var e=[].slice.call(arguments,2);return U.getShim().exec.call(this,this.uid,b,J,e)},exec:function(b,J){var e=[].slice.call(arguments,2);return U[b]&&U[b][J]?U[b][J].apply(this,e):U.shimExec.apply(this,arguments)},destroy:function(){if(U){var b=e.get(this.shimid);b&&b.parentNode.removeChild(b),d&&d.removeAllInstances(),this.unbindAll(),delete Qc[this.uid],this.uid=null,bV=U=d=b=null}}}),this.mode&&b.required_caps&&!this.can(b.required_caps)&&(this.mode=!1)}var g={},Qc={};return ed.order="html5,flash,silverlight,html4",ed.getRuntime=function(b){return Qc[b]?Qc[b]:!1},ed.addConstructor=function(b,J){J.prototype=Q.instance,g[b]=J},ed.getConstructor=function(b){return g[b]||null},ed.getInfo=function(b){var J=ed.getRuntime(b);return J?{uid:J.uid,type:J.type,mode:J.mode,can:function(){return J.can.apply(J,arguments)}}:null},ed.parseCaps=function(b){var e={};return"string"!==J.typeOf(b)?b||{}:(J.each(b.split(","),function(b){e[b]=!0}),e)},ed.can=function(b,J){var e,Q,g=ed.getConstructor(b);return g?(e=new g({required_caps:J}),Q=e.mode,e.destroy(),!!Q):!1},ed.thatCan=function(b,J){var e=(J||ed.order).split(/\s*,\s*/);for(var Q in e)if(ed.can(e[Q],b))return e[Q];return null},ed.getMode=function(b,e,Q){var ed=null;if("undefined"===J.typeOf(Q)&&(Q="browser"),e&&!J.isEmptyObj(b)){if(J.each(e,function(e,Q){if(b.hasOwnProperty(Q)){var g=b[Q](e);if("string"==typeof g&&(g=[g]),ed){if(!(ed=J.arrayIntersect(ed,g)))return ed=!1}else ed=g}}),ed)return-1!==J.inArray(Q,ed)?Q:ed[0];if(ed===!1)return!1}return Q},ed.capTrue=function(){return!0},ed.capFalse=function(){return!1},ed.capTest=function(b){return function(){return!!b}},ed}),Q("moxie/runtime/RuntimeClient",["moxie/core/utils/Env","moxie/core/Exceptions","moxie/core/utils/Basic","moxie/runtime/Runtime"],function(b,J,e,Q){return function(){var b;e.extend(this,{connectRuntime:function(ed){function g(e){var Qc,A;return e.length?(Qc=e.shift().toLowerCase(),(A=Q.getConstructor(Qc))?(b=new A(ed),b.bind("Init",function(){b.initialized=!0,setTimeout(function(){b.clients++,bc.ruid=b.uid,bc.trigger("RuntimeInit",b)},1)}),b.bind("Error",function(){b.destroy(),g(e)}),b.bind("Exception",function(b,e){var Q=e.name+"(#"+e.code+")"+(e.message?", from: "+e.message:"");bc.trigger("RuntimeError",new J.RuntimeError(J.RuntimeError.EXCEPTION_ERR,Q))}),b.mode?(b.init(),void 0):(b.trigger("Error"),void 0)):(g(e),void 0)):(bc.trigger("RuntimeError",new J.RuntimeError(J.RuntimeError.NOT_INIT_ERR)),b=null,void 0)}var Qc,bc=this;if("string"===e.typeOf(ed)?Qc=ed:"string"===e.typeOf(ed.ruid)&&(Qc=ed.ruid),Qc){if(b=Q.getRuntime(Qc))return bc.ruid=Qc,b.clients++,b;throw new J.RuntimeError(J.RuntimeError.NOT_INIT_ERR)}g((ed.runtime_order||Q.order).split(/\s*,\s*/))},disconnectRuntime:function(){b&&--b.clients<=0&&b.destroy(),b=null},getRuntime:function(){return b&&b.uid?b:b=null},exec:function(){return b?b.exec.apply(this,arguments):null},can:function(J){return b?b.can(J):!1}})}}),Q("moxie/file/Blob",["moxie/core/utils/Basic","moxie/core/utils/Encode","moxie/runtime/RuntimeClient"],function(b,J,e){function Q(g,Qc){function bc(J,e,g){var Qc,bc=ed[this.uid];return"string"===b.typeOf(bc)&&bc.length?(Qc=new Q(null,{type:g,size:e-J}),Qc.detach(bc.substr(J,Qc.size)),Qc):null}e.call(this),g&&this.connectRuntime(g),Qc?"string"===b.typeOf(Qc)&&(Qc={data:Qc}):Qc={},b.extend(this,{uid:Qc.uid||b.guid("uid_"),ruid:g,size:Qc.size||0,type:Qc.type||"",slice:function(b,J,e){return this.isDetached()?bc.apply(this,arguments):this.getRuntime().exec.call(this,"Blob","slice",this.getSource(),b,J,e)},getSource:function(){return ed[this.uid]?ed[this.uid]:null},detach:function(b){if(this.ruid&&(this.getRuntime().exec.call(this,"Blob","destroy"),this.disconnectRuntime(),this.ruid=null),b=b||"","data:"==b.substr(0,5)){var e=b.indexOf(";base64,");this.type=b.substring(5,e),b=J.atob(b.substring(e+8))}this.size=b.length,ed[this.uid]=b},isDetached:function(){return!this.ruid&&"string"===b.typeOf(ed[this.uid])},destroy:function(){this.detach(),delete ed[this.uid]}}),Qc.data?this.detach(Qc.data):ed[this.uid]=Qc}var ed={};return Q}),Q("moxie/core/I18n",["moxie/core/utils/Basic"],function(b){var J={};return{addI18n:function(e){return b.extend(J,e)},translate:function(b){return J[b]||b},_:function(b){return this.translate(b)},sprintf:function(J){var e=[].slice.call(arguments,1);return J.replace(/%[a-z]/g,function(){var J=e.shift();return"undefined"!==b.typeOf(J)?J:""})}}}),Q("moxie/core/utils/Mime",["moxie/core/utils/Basic","moxie/core/I18n"],function(b,J){var e="application/msword,doc dot,application/pdf,pdf,application/pgp-signature,pgp,application/postscript,ps ai eps,application/rtf,rtf,application/vnd.ms-excel,xls xlb,application/vnd.ms-powerpoint,ppt pps pot,application/zip,zip,application/x-shockwave-flash,swf swfl,application/vnd.openxmlformats-officedocument.wordprocessingml.document,docx,application/vnd.openxmlformats-officedocument.wordprocessingml.template,dotx,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,xlsx,application/vnd.openxmlformats-officedocument.presentationml.presentation,pptx,application/vnd.openxmlformats-officedocument.presentationml.template,potx,application/vnd.openxmlformats-officedocument.presentationml.slideshow,ppsx,application/x-javascript,js,application/json,json,audio/mpeg,mp3 mpga mpega mp2,audio/x-wav,wav,audio/x-m4a,m4a,audio/ogg,oga ogg,audio/aiff,aiff aif,audio/flac,flac,audio/aac,aac,audio/ac3,ac3,audio/x-ms-wma,wma,image/bmp,bmp,image/gif,gif,image/jpeg,jpg jpeg jpe,image/photoshop,psd,image/png,png,image/svg+xml,svg svgz,image/tiff,tiff tif,text/plain,asc txt text diff log,text/html,htm html xhtml,text/css,css,text/csv,csv,text/rtf,rtf,video/mpeg,mpeg mpg mpe m2v,video/quicktime,qt mov,video/mp4,mp4,video/x-m4v,m4v,video/x-flv,flv,video/x-ms-wmv,wmv,video/avi,avi,video/webm,webm,video/3gpp,3gpp 3gp,video/3gpp2,3g2,video/vnd.rn-realvideo,rv,video/ogg,ogv,video/x-matroska,mkv,application/vnd.oasis.opendocument.formula-template,otf,application/octet-stream,exe",Q={mimes:{},extensions:{},addMimeType:function(b){var J,e,Q,ed=b.split(/,/);for(J=0;J<ed.length;J+=2){for(Q=ed[J+1].split(/ /),e=0;e<Q.length;e++)this.mimes[Q[e]]=ed[J];this.extensions[ed[J]]=Q}},extList2mimes:function(J,e){var Q,ed,g,Qc,bc=this,A=[];for(ed=0;ed<J.length;ed++)for(Q=J[ed].extensions.split(/\s*,\s*/),g=0;g<Q.length;g++){if("*"===Q[g])return[];if(Qc=bc.mimes[Q[g]],Qc&&-1===b.inArray(Qc,A)&&A.push(Qc),e&&/^\w+$/.test(Q[g]))A.push("."+Q[g]);else if(!Qc)return[]}return A},mimes2exts:function(J){var e=this,Q=[];return b.each(J,function(J){if("*"===J)return Q=[],!1;var ed=J.match(/^(\w+)\/(\*|\w+)$/);ed&&("*"===ed[2]?b.each(e.extensions,function(b,J){new RegExp("^"+ed[1]+"/").test(J)&&[].push.apply(Q,e.extensions[J])}):e.extensions[J]&&[].push.apply(Q,e.extensions[J]))}),Q},mimes2extList:function(e){var Q=[],ed=[];return"string"===b.typeOf(e)&&(e=b.trim(e).split(/\s*,\s*/)),ed=this.mimes2exts(e),Q.push({title:J.translate("Files"),extensions:ed.length?ed.join(","):"*"}),Q.mimes=e,Q},getFileExtension:function(b){var J=b&&b.match(/\.([^.]+)$/);return J?J[1].toLowerCase():""},getFileMime:function(b){return this.mimes[this.getFileExtension(b)]||""}};return Q.addMimeType(e),Q}),Q("moxie/file/FileInput",["moxie/core/utils/Basic","moxie/core/utils/Env","moxie/core/utils/Mime","moxie/core/utils/Dom","moxie/core/Exceptions","moxie/core/EventTarget","moxie/core/I18n","moxie/runtime/Runtime","moxie/runtime/RuntimeClient"],function(b,J,e,Q,ed,g,Qc,bc,A){function d(J){var g,d,bV;if(-1!==b.inArray(b.typeOf(J),["string","node"])&&(J={browse_button:J}),d=Q.get(J.browse_button),!d)throw new ed.DOMException(ed.DOMException.NOT_FOUND_ERR);bV={accept:[{title:Qc.translate("All Files"),extensions:"*"}],multiple:!1,required_caps:!1,container:d.parentNode||document.body},J=b.extend({},bV,J),"string"==typeof J.required_caps&&(J.required_caps=bc.parseCaps(J.required_caps)),"string"==typeof J.accept&&(J.accept=e.mimes2extList(J.accept)),g=Q.get(J.container),g||(g=document.body),"static"===Q.getStyle(g,"position")&&(g.style.position="relative"),g=d=null,A.call(this),b.extend(this,{uid:b.guid("uid_"),ruid:null,shimid:null,files:null,init:function(){var e=this;e.bind("RuntimeInit",function(ed,g){e.ruid=g.uid,e.shimid=g.shimid,e.bind("Ready",function(){e.trigger("Refresh")},999),e.bind("Refresh",function(){var e,ed,Qc,bc,A;Qc=Q.get(J.browse_button),bc=Q.get(g.shimid),Qc&&(e=Q.getPos(Qc,Q.get(J.container)),ed=Q.getSize(Qc),A=parseInt(Q.getStyle(Qc,"z-index"),10)||0,bc&&b.extend(bc.style,{top:e.y+"px",left:e.x+"px",width:ed.w+"px",height:ed.h+"px",zIndex:A+1})),bc=Qc=null}),g.exec.call(e,"FileInput","init",J)}),e.connectRuntime(b.extend({},J,{required_caps:{select_file:!0}}))},getOption:function(b){return J[b]},setOption:function(b,Q){if(J.hasOwnProperty(b)){var g=J[b];switch(b){case"accept":"string"==typeof Q&&(Q=e.mimes2extList(Q));break;case"container":case"required_caps":throw new ed.FileException(ed.FileException.NO_MODIFICATION_ALLOWED_ERR)}J[b]=Q,this.exec("FileInput","setOption",b,Q),this.trigger("OptionChanged",b,Q,g)}},disable:function(J){var e=this.getRuntime();e&&this.exec("FileInput","disable","undefined"===b.typeOf(J)?!0:J)},refresh:function(){this.trigger("Refresh")},destroy:function(){var J=this.getRuntime();J&&(J.exec.call(this,"FileInput","destroy"),this.disconnectRuntime()),"array"===b.typeOf(this.files)&&b.each(this.files,function(b){b.destroy()}),this.files=null,this.unbindAll()}}),this.handleEventProps(U)}var U=["ready","change","cancel","mouseenter","mouseleave","mousedown","mouseup"];return d.prototype=g.instance,d}),Q("moxie/file/File",["moxie/core/utils/Basic","moxie/core/utils/Mime","moxie/file/Blob"],function(b,J,e){function Q(Q,ed){ed||(ed={}),e.apply(this,arguments),this.type||(this.type=J.getFileMime(ed.name));var g;if(ed.name)g=ed.name.replace(/\\/g,"/"),g=g.substr(g.lastIndexOf("/")+1);else if(this.type){var Qc=this.type.split("/")[0];g=b.guid((""!==Qc?Qc:"file")+"_"),J.extensions[this.type]&&(g+="."+J.extensions[this.type][0])}b.extend(this,{name:g||b.guid("file_"),relativePath:"",lastModifiedDate:ed.lastModifiedDate||(new Date).toLocaleString()})}return Q.prototype=e.prototype,Q}),Q("moxie/file/FileDrop",["moxie/core/I18n","moxie/core/utils/Dom","moxie/core/Exceptions","moxie/core/utils/Basic","moxie/core/utils/Env","moxie/file/File","moxie/runtime/RuntimeClient","moxie/core/EventTarget","moxie/core/utils/Mime"],function(b,J,e,Q,ed,g,Qc,bc,A){function d(e){var ed,g=this;"string"==typeof e&&(e={drop_zone:e}),ed={accept:[{title:b.translate("All Files"),extensions:"*"}],required_caps:{drag_and_drop:!0}},e="object"==typeof e?Q.extend({},ed,e):ed,e.container=J.get(e.drop_zone)||document.body,"static"===J.getStyle(e.container,"position")&&(e.container.style.position="relative"),"string"==typeof e.accept&&(e.accept=A.mimes2extList(e.accept)),Qc.call(g),Q.extend(g,{uid:Q.guid("uid_"),ruid:null,files:null,init:function(){g.bind("RuntimeInit",function(b,J){g.ruid=J.uid,J.exec.call(g,"FileDrop","init",e),g.dispatchEvent("ready")}),g.connectRuntime(e)},destroy:function(){var b=this.getRuntime();b&&(b.exec.call(this,"FileDrop","destroy"),this.disconnectRuntime()),this.files=null,this.unbindAll()}}),this.handleEventProps(U)}var U=["ready","dragenter","dragleave","drop","error"];return d.prototype=bc.instance,d}),Q("moxie/file/FileReader",["moxie/core/utils/Basic","moxie/core/utils/Encode","moxie/core/Exceptions","moxie/core/EventTarget","moxie/file/Blob","moxie/runtime/RuntimeClient"],function(b,J,e,Q,ed,g){function Qc(){function Q(b,Q){if(this.trigger("loadstart"),this.readyState===Qc.LOADING)return this.trigger("error",new e.DOMException(e.DOMException.INVALID_STATE_ERR)),this.trigger("loadend"),void 0;if(!(Q instanceof ed))return this.trigger("error",new e.DOMException(e.DOMException.NOT_FOUND_ERR)),this.trigger("loadend"),void 0;if(this.result=null,this.readyState=Qc.LOADING,Q.isDetached()){var g=Q.getSource();switch(b){case"readAsText":case"readAsBinaryString":this.result=g;break;case"readAsDataURL":this.result="data:"+Q.type+";base64,"+J.btoa(g)}this.readyState=Qc.DONE,this.trigger("load"),this.trigger("loadend")}else this.connectRuntime(Q.ruid),this.exec("FileReader","read",b,Q)}g.call(this),b.extend(this,{uid:b.guid("uid_"),readyState:Qc.EMPTY,result:null,error:null,readAsBinaryString:function(b){Q.call(this,"readAsBinaryString",b)},readAsDataURL:function(b){Q.call(this,"readAsDataURL",b)},readAsText:function(b){Q.call(this,"readAsText",b)},abort:function(){this.result=null,-1===b.inArray(this.readyState,[Qc.EMPTY,Qc.DONE])&&(this.readyState===Qc.LOADING&&(this.readyState=Qc.DONE),this.exec("FileReader","abort"),this.trigger("abort"),this.trigger("loadend"))},destroy:function(){this.abort(),this.exec("FileReader","destroy"),this.disconnectRuntime(),this.unbindAll()}}),this.handleEventProps(bc),this.bind("Error",function(b,J){this.readyState=Qc.DONE,this.error=J},999),this.bind("Load",function(){this.readyState=Qc.DONE},999)}var bc=["loadstart","progress","load","abort","error","loadend"];return Qc.EMPTY=0,Qc.LOADING=1,Qc.DONE=2,Qc.prototype=Q.instance,Qc}),Q("moxie/core/utils/Url",[],function(){var b=function(J,e){for(var Q=["source","scheme","authority","userInfo","user","pass","host","port","relative","path","directory","file","query","fragment"],ed=Q.length,g={http:80,https:443},Qc={},bc=/^(?:([^:\/?#]+):)?(?:\/\/()(?:(?:()(?:([^:@\/]*):?([^:@\/]*))?@)?([^:\/?#]*)(?::(\d*))?))?()(?:(()(?:(?:[^?#\/]*\/)*)()(?:[^?#]*))(?:\\?([^#]*))?(?:#(.*))?)/,A=bc.exec(J||"");ed--;)A[ed]&&(Qc[Q[ed]]=A[ed]);if(!Qc.scheme){e&&"string"!=typeof e||(e=b(e||document.location.href)),Qc.scheme=e.scheme,Qc.host=e.host,Qc.port=e.port;var d="";/^[^\/]/.test(Qc.path)&&(d=e.path,d=/\/[^\/]*\.[^\/]*$/.test(d)?d.replace(/\/[^\/]+$/,"/"):d.replace(/\/?$/,"/")),Qc.path=d+(Qc.path||"")}return Qc.port||(Qc.port=g[Qc.scheme]||80),Qc.port=parseInt(Qc.port,10),Qc.path||(Qc.path="/"),delete Qc.source,Qc},J=function(J){var e={http:80,https:443},Q="object"==typeof J?J:b(J);return Q.scheme+"://"+Q.host+(Q.port!==e[Q.scheme]?":"+Q.port:"")+Q.path+(Q.query?Q.query:"")},e=function(J){function e(b){return[b.scheme,b.host,b.port].join("/")}return"string"==typeof J&&(J=b(J)),e(b())===e(J)};return{parseUrl:b,resolveUrl:J,hasSameOrigin:e}}),Q("moxie/runtime/RuntimeTarget",["moxie/core/utils/Basic","moxie/runtime/RuntimeClient","moxie/core/EventTarget"],function(b,J,e){function Q(){this.uid=b.guid("uid_"),J.call(this),this.destroy=function(){this.disconnectRuntime(),this.unbindAll()}}return Q.prototype=e.instance,Q}),Q("moxie/file/FileReaderSync",["moxie/core/utils/Basic","moxie/runtime/RuntimeClient","moxie/core/utils/Encode"],function(b,J,e){return function(){function Q(b,J){if(!J.isDetached()){var Q=this.connectRuntime(J.ruid).exec.call(this,"FileReaderSync","read",b,J);return this.disconnectRuntime(),Q}var ed=J.getSource();switch(b){case"readAsBinaryString":return ed;case"readAsDataURL":return"data:"+J.type+";base64,"+e.btoa(ed);case"readAsText":for(var g="",Qc=0,bc=ed.length;bc>Qc;Qc++)g+=String.fromCharCode(ed[Qc]);return g}}J.call(this),b.extend(this,{uid:b.guid("uid_"),readAsBinaryString:function(b){return Q.call(this,"readAsBinaryString",b)},readAsDataURL:function(b){return Q.call(this,"readAsDataURL",b)},readAsText:function(b){return Q.call(this,"readAsText",b)}})}}),Q("moxie/xhr/FormData",["moxie/core/Exceptions","moxie/core/utils/Basic","moxie/file/Blob"],function(b,J,e){function Q(){var b,Q=[];J.extend(this,{append:function(ed,g){var Qc=this,bc=J.typeOf(g);g instanceof e?b={name:ed,value:g}:"array"===bc?(ed+="[]",J.each(g,function(b){Qc.append(ed,b)})):"object"===bc?J.each(g,function(b,J){Qc.append(ed+"["+J+"]",b)}):"null"===bc||"undefined"===bc||"number"===bc&&isNaN(g)?Qc.append(ed,"false"):Q.push({name:ed,value:g.toString()})},hasBlob:function(){return!!this.getBlob()},getBlob:function(){return b&&b.value||null},getBlobName:function(){return b&&b.name||null},each:function(e){J.each(Q,function(b){e(b.value,b.name)}),b&&e(b.value,b.name)},destroy:function(){b=null,Q=[]}})}return Q}),Q("moxie/xhr/XMLHttpRequest",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/core/EventTarget","moxie/core/utils/Encode","moxie/core/utils/Url","moxie/runtime/Runtime","moxie/runtime/RuntimeTarget","moxie/file/Blob","moxie/file/FileReaderSync","moxie/xhr/FormData","moxie/core/utils/Env","moxie/core/utils/Mime"],function(b,J,e,Q,ed,g,Qc,bc,A,d,U,bV){function bI(){this.uid=b.guid("uid_")}function a(){function e(b,J){return eb.hasOwnProperty(b)?1===arguments.length?U.can("define_property")?eb[b]:f[b]:(U.can("define_property")?eb[b]=J:f[b]=J,void 0):void 0}function A(J){function Q(){gc&&(gc.destroy(),gc=null),bc.dispatchEvent("loadend"),bc=null}function ed(ed){gc.bind("LoadStart",function(b){e("readyState",a.LOADING),bc.dispatchEvent("readystatechange"),bc.dispatchEvent(b),aL&&bc.upload.dispatchEvent(b)}),gc.bind("Progress",function(b){e("readyState")!==a.LOADING&&(e("readyState",a.LOADING),bc.dispatchEvent("readystatechange")),bc.dispatchEvent(b)}),gc.bind("UploadProgress",function(b){aL&&bc.upload.dispatchEvent({type:"progress",lengthComputable:!1,total:b.total,loaded:b.loaded})}),gc.bind("Load",function(J){e("readyState",a.DONE),e("status",Number(ed.exec.call(gc,"XMLHttpRequest","getStatus")||0)),e("statusText",h[e("status")]||""),e("response",ed.exec.call(gc,"XMLHttpRequest","getResponse",e("responseType"))),~b.inArray(e("responseType"),["text",""])?e("responseText",e("response")):"document"===e("responseType")&&e("responseXML",e("response")),m=ed.exec.call(gc,"XMLHttpRequest","getAllResponseHeaders"),bc.dispatchEvent("readystatechange"),e("status")>0?(aL&&bc.upload.dispatchEvent(J),bc.dispatchEvent(J)):(eM=!0,bc.dispatchEvent("error")),Q()}),gc.bind("Abort",function(b){bc.dispatchEvent(b),Q()}),gc.bind("Error",function(b){eM=!0,e("readyState",a.DONE),bc.dispatchEvent("readystatechange"),ab=!0,bc.dispatchEvent(b),Q()}),ed.exec.call(gc,"XMLHttpRequest","send",{url:bb,method:ee,async:E,user:de,password:gS,headers:hd,mimeType:ch,encoding:cS,responseType:bc.responseType,withCredentials:bc.withCredentials,options:l},J)}var bc=this;aH=(new Date).getTime(),gc=new Qc,"string"==typeof l.required_caps&&(l.required_caps=g.parseCaps(l.required_caps)),l.required_caps=b.extend({},l.required_caps,{return_response_type:bc.responseType}),J instanceof d&&(l.required_caps.send_multipart=!0),b.isEmptyObj(hd)||(l.required_caps.send_custom_headers=!0),i||(l.required_caps.do_cors=!0),l.ruid?ed(gc.connectRuntime(l)):(gc.bind("RuntimeInit",function(b,J){ed(J)}),gc.bind("RuntimeError",function(b,J){bc.dispatchEvent("RuntimeError",J)}),gc.connectRuntime(l))}function N(){e("responseText",""),e("responseXML",null),e("response",null),e("status",0),e("statusText",""),aH=gE=null}var bb,ee,de,gS,aH,gE,gc,gf,f=this,eb={timeout:0,readyState:a.UNSENT,withCredentials:!1,status:0,statusText:"",responseType:"",responseXML:null,responseText:null,response:null},E=!0,hd={},cS=null,ch=null,bB=!1,gU=!1,aL=!1,ab=!1,eM=!1,i=!1,j=null,k=null,l={},m="";b.extend(this,eb,{uid:b.guid("uid_"),upload:new bI,open:function(g,Qc,bc,A,d){var U;if(!g||!Qc)throw new J.DOMException(J.DOMException.SYNTAX_ERR);if(/[\u0100-\uffff]/.test(g)||Q.utf8_encode(g)!==g)throw new J.DOMException(J.DOMException.SYNTAX_ERR);if(~b.inArray(g.toUpperCase(),["CONNECT","DELETE","GET","HEAD","OPTIONS","POST","PUT","TRACE","TRACK"])&&(ee=g.toUpperCase()),~b.inArray(ee,["CONNECT","TRACE","TRACK"]))throw new J.DOMException(J.DOMException.SECURITY_ERR);if(Qc=Q.utf8_encode(Qc),U=ed.parseUrl(Qc),i=ed.hasSameOrigin(U),bb=ed.resolveUrl(Qc),(A||d)&&!i)throw new J.DOMException(J.DOMException.INVALID_ACCESS_ERR);if(de=A||U.user,gS=d||U.pass,E=bc||!0,E===!1&&(e("timeout")||e("withCredentials")||""!==e("responseType")))throw new J.DOMException(J.DOMException.INVALID_ACCESS_ERR);bB=!E,gU=!1,hd={},N.call(this),e("readyState",a.OPENED),this.dispatchEvent("readystatechange")},setRequestHeader:function(ed,g){var Qc=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","cookie","cookie2","content-transfer-encoding","date","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","user-agent","via"];if(e("readyState")!==a.OPENED||gU)throw new J.DOMException(J.DOMException.INVALID_STATE_ERR);if(/[\u0100-\uffff]/.test(ed)||Q.utf8_encode(ed)!==ed)throw new J.DOMException(J.DOMException.SYNTAX_ERR);return ed=b.trim(ed).toLowerCase(),~b.inArray(ed,Qc)||/^(proxy\-|sec\-)/.test(ed)?!1:(hd[ed]?hd[ed]+=", "+g:hd[ed]=g,!0)},hasRequestHeader:function(b){return b&&hd[b.toLowerCase()]||!1},getAllResponseHeaders:function(){return m||""},getResponseHeader:function(J){return J=J.toLowerCase(),eM||~b.inArray(J,["set-cookie","set-cookie2"])?null:m&&""!==m&&(gf||(gf={},b.each(m.split(/\r\n/),function(J){var e=J.split(/:\s+/);2===e.length&&(e[0]=b.trim(e[0]),gf[e[0].toLowerCase()]={header:e[0],value:b.trim(e[1])})})),gf.hasOwnProperty(J))?gf[J].header+": "+gf[J].value:null},overrideMimeType:function(Q){var ed,g;if(~b.inArray(e("readyState"),[a.LOADING,a.DONE]))throw new J.DOMException(J.DOMException.INVALID_STATE_ERR);if(Q=b.trim(Q.toLowerCase()),/;/.test(Q)&&(ed=Q.match(/^([^;]+)(?:;\scharset\=)?(.*)$/))&&(Q=ed[1],ed[2]&&(g=ed[2])),!bV.mimes[Q])throw new J.DOMException(J.DOMException.SYNTAX_ERR);j=Q,k=g},send:function(e,ed){if(l="string"===b.typeOf(ed)?{ruid:ed}:ed?ed:{},this.readyState!==a.OPENED||gU)throw new J.DOMException(J.DOMException.INVALID_STATE_ERR);if(e instanceof bc)l.ruid=e.ruid,ch=e.type||"application/octet-stream";else if(e instanceof d){if(e.hasBlob()){var g=e.getBlob();l.ruid=g.ruid,ch=g.type||"application/octet-stream"}}else"string"==typeof e&&(cS="UTF-8",ch="text/plain;charset=UTF-8",e=Q.utf8_encode(e));this.withCredentials||(this.withCredentials=l.required_caps&&l.required_caps.send_browser_cookies&&!i),aL=!bB&&this.upload.hasEventListener(),eM=!1,ab=!e,bB||(gU=!0),A.call(this,e)},abort:function(){if(eM=!0,bB=!1,~b.inArray(e("readyState"),[a.UNSENT,a.OPENED,a.DONE]))e("readyState",a.UNSENT);else{if(e("readyState",a.DONE),gU=!1,!gc)throw new J.DOMException(J.DOMException.INVALID_STATE_ERR);gc.getRuntime().exec.call(gc,"XMLHttpRequest","abort",ab),ab=!0}},destroy:function(){gc&&("function"===b.typeOf(gc.destroy)&&gc.destroy(),gc=null),this.unbindAll(),this.upload&&(this.upload.unbindAll(),this.upload=null)}}),this.handleEventProps(c.concat(["readystatechange"])),this.upload.handleEventProps(c)}var h={100:"Continue",101:"Switching Protocols",102:"Processing",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",306:"Reserved",307:"Temporary Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Request Entity Too Large",414:"Request-URI Too Long",415:"Unsupported Media Type",416:"Requested Range Not Satisfiable",417:"Expectation Failed",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",426:"Upgrade Required",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",510:"Not Extended"};bI.prototype=e.instance;var c=["loadstart","progress","abort","error","load","timeout","loadend"];return a.UNSENT=0,a.OPENED=1,a.HEADERS_RECEIVED=2,a.LOADING=3,a.DONE=4,a.prototype=e.instance,a}),Q("moxie/runtime/Transporter",["moxie/core/utils/Basic","moxie/core/utils/Encode","moxie/runtime/RuntimeClient","moxie/core/EventTarget"],function(b,J,e,Q){function ed(){function Q(){U=bV=0,d=this.result=null}function g(J,e){var Q=this;A=e,Q.bind("TransportingProgress",function(J){bV=J.loaded,U>bV&&-1===b.inArray(Q.state,[ed.IDLE,ed.DONE])&&Qc.call(Q)},999),Q.bind("TransportingComplete",function(){bV=U,Q.state=ed.DONE,d=null,Q.result=A.exec.call(Q,"Transporter","getAsBlob",J||"")},999),Q.state=ed.BUSY,Q.trigger("TransportingStarted"),Qc.call(Q)}function Qc(){var b,e=this,Q=U-bV;bI>Q&&(bI=Q),b=J.btoa(d.substr(bV,bI)),A.exec.call(e,"Transporter","receive",b,U)}var bc,A,d,U,bV,bI;e.call(this),b.extend(this,{uid:b.guid("uid_"),state:ed.IDLE,result:null,transport:function(J,e,ed){var Qc=this;if(ed=b.extend({chunk_size:204798},ed),(bc=ed.chunk_size%3)&&(ed.chunk_size+=3-bc),bI=ed.chunk_size,Q.call(this),d=J,U=J.length,"string"===b.typeOf(ed)||ed.ruid)g.call(Qc,e,this.connectRuntime(ed));else{var A=function(b,J){Qc.unbind("RuntimeInit",A),g.call(Qc,e,J)};this.bind("RuntimeInit",A),this.connectRuntime(ed)}},abort:function(){var b=this;b.state=ed.IDLE,A&&(A.exec.call(b,"Transporter","clear"),b.trigger("TransportingAborted")),Q.call(b)},destroy:function(){this.unbindAll(),A=null,this.disconnectRuntime(),Q.call(this)}})}return ed.IDLE=0,ed.BUSY=1,ed.DONE=2,ed.prototype=Q.instance,ed}),Q("moxie/image/Image",["moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/Exceptions","moxie/file/FileReaderSync","moxie/xhr/XMLHttpRequest","moxie/runtime/Runtime","moxie/runtime/RuntimeClient","moxie/runtime/Transporter","moxie/core/utils/Env","moxie/core/EventTarget","moxie/file/Blob","moxie/file/File","moxie/core/utils/Encode"],function(b,J,e,Q,ed,g,Qc,bc,A,d,U,bV,bI){function a(){function Q(b){try{return b||(b=this.exec("Image","getInfo")),this.size=b.size,this.width=b.width,this.height=b.height,this.type=b.type,this.meta=b.meta,""===this.name&&(this.name=b.name),!0}catch(b){return this.trigger("error",b.code),!1}}function d(J){var Q=b.typeOf(J);try{if(J instanceof a){if(!J.size)throw new e.DOMException(e.DOMException.INVALID_STATE_ERR);c.apply(this,arguments)}else if(J instanceof U){if(!~b.inArray(J.type,["image/jpeg","image/png"]))throw new e.ImageError(e.ImageError.WRONG_FORMAT);N.apply(this,arguments)}else if(-1!==b.inArray(Q,["blob","file"]))d.call(this,new bV(null,J),arguments[1]);else if("string"===Q)"data:"===J.substr(0,5)?d.call(this,new U(null,{data:J}),arguments[1]):bb.apply(this,arguments);else{if("node"!==Q||"img"!==J.nodeName.toLowerCase())throw new e.DOMException(e.DOMException.TYPE_MISMATCH_ERR);d.call(this,J.src,arguments[1])}}catch(b){this.trigger("error",b.code)}}function c(J,e){var Q=this.connectRuntime(J.ruid);this.ruid=Q.uid,Q.exec.call(this,"Image","loadFromImage",J,"undefined"===b.typeOf(e)?!0:e)}function N(J,e){function Q(b){ed.ruid=b.uid,b.exec.call(ed,"Image","loadFromBlob",J)}var ed=this;ed.name=J.name||"",J.isDetached()?(this.bind("RuntimeInit",function(b,J){Q(J)}),e&&"string"==typeof e.required_caps&&(e.required_caps=g.parseCaps(e.required_caps)),this.connectRuntime(b.extend({required_caps:{access_image_binary:!0,resize_image:!0}},e))):Q(this.connectRuntime(J.ruid))}function bb(b,J){var e,Q=this;e=new ed,e.open("get",b),e.responseType="blob",e.onprogress=function(b){Q.trigger(b)},e.onload=function(){N.call(Q,e.response,!0)},e.onerror=function(b){Q.trigger(b)},e.onloadend=function(){e.destroy()},e.bind("RuntimeError",function(b,J){Q.trigger("RuntimeError",J)}),e.send(null,J)}Qc.call(this),b.extend(this,{uid:b.guid("uid_"),ruid:null,name:"",size:0,width:0,height:0,type:"",meta:{},clone:function(){this.load.apply(this,arguments)},load:function(){d.apply(this,arguments)},resize:function(J){var Q,ed,g=this,Qc={x:0,y:0,width:g.width,height:g.height},bc=b.extendIf({width:g.width,height:g.height,type:g.type||"image/jpeg",quality:90,crop:!1,fit:!0,preserveHeaders:!0,resample:"default",multipass:!0},J);try{if(!g.size)throw new e.DOMException(e.DOMException.INVALID_STATE_ERR);if(g.width>a.MAX_RESIZE_WIDTH||g.height>a.MAX_RESIZE_HEIGHT)throw new e.ImageError(e.ImageError.MAX_RESOLUTION_ERR);if(Q=g.meta&&g.meta.tiff&&g.meta.tiff.Orientation||1,-1!==b.inArray(Q,[5,6,7,8])){var A=bc.width;bc.width=bc.height,bc.height=A}if(bc.crop){switch(ed=Math.max(bc.width/g.width,bc.height/g.height),J.fit?(Qc.width=Math.min(Math.ceil(bc.width/ed),g.width),Qc.height=Math.min(Math.ceil(bc.height/ed),g.height),ed=bc.width/Qc.width):(Qc.width=Math.min(bc.width,g.width),Qc.height=Math.min(bc.height,g.height),ed=1),"boolean"==typeof bc.crop&&(bc.crop="cc"),bc.crop.toLowerCase().replace(/_/,"-")){case"rb":case"right-bottom":Qc.x=g.width-Qc.width,Qc.y=g.height-Qc.height;break;case"cb":case"center-bottom":Qc.x=Math.floor((g.width-Qc.width)/2),Qc.y=g.height-Qc.height;break;case"lb":case"left-bottom":Qc.x=0,Qc.y=g.height-Qc.height;break;case"lt":case"left-top":Qc.x=0,Qc.y=0;break;case"ct":case"center-top":Qc.x=Math.floor((g.width-Qc.width)/2),Qc.y=0;break;case"rt":case"right-top":Qc.x=g.width-Qc.width,Qc.y=0;break;case"rc":case"right-center":case"right-middle":Qc.x=g.width-Qc.width,Qc.y=Math.floor((g.height-Qc.height)/2);break;case"lc":case"left-center":case"left-middle":Qc.x=0,Qc.y=Math.floor((g.height-Qc.height)/2);break;case"cc":case"center-center":case"center-middle":default:Qc.x=Math.floor((g.width-Qc.width)/2),Qc.y=Math.floor((g.height-Qc.height)/2)}Qc.x=Math.max(Qc.x,0),Qc.y=Math.max(Qc.y,0)}else ed=Math.min(bc.width/g.width,bc.height/g.height);this.exec("Image","resize",Qc,ed,bc)}catch(b){g.trigger("error",b.code)}},downsize:function(J){var e,Q={width:this.width,height:this.height,type:this.type||"image/jpeg",quality:90,crop:!1,preserveHeaders:!0,resample:"default"};e="object"==typeof J?b.extend(Q,J):b.extend(Q,{width:arguments[0],height:arguments[1],crop:arguments[2],preserveHeaders:arguments[3]}),this.resize(e)},crop:function(b,J,e){this.downsize(b,J,!0,e)},getAsCanvas:function(){if(!A.can("create_canvas"))throw new e.RuntimeError(e.RuntimeError.NOT_SUPPORTED_ERR);var b=this.connectRuntime(this.ruid);return b.exec.call(this,"Image","getAsCanvas")},getAsBlob:function(b,J){if(!this.size)throw new e.DOMException(e.DOMException.INVALID_STATE_ERR);return this.exec("Image","getAsBlob",b||"image/jpeg",J||90)},getAsDataURL:function(b,J){if(!this.size)throw new e.DOMException(e.DOMException.INVALID_STATE_ERR);return this.exec("Image","getAsDataURL",b||"image/jpeg",J||90)},getAsBinaryString:function(b,J){var e=this.getAsDataURL(b,J);return bI.atob(e.substring(e.indexOf("base64,")+7))},embed:function(Q,ed){function g(J,ed){var g=this;if(A.can("create_canvas")){var U=g.getAsCanvas();if(U)return Q.appendChild(U),U=null,g.destroy(),d.trigger("embedded"),void 0}var bV=g.getAsDataURL(J,ed);if(!bV)throw new e.ImageError(e.ImageError.WRONG_FORMAT);if(A.can("use_data_uri_of",bV.length))Q.innerHTML='<img src="'+bV+'" width="'+g.width+'" height="'+g.height+'" />',g.destroy(),d.trigger("embedded");else{var a=new bc;a.bind("TransportingComplete",function(){Qc=d.connectRuntime(this.result.ruid),d.bind("Embedded",function(){b.extend(Qc.getShimContainer().style,{top:"0px",left:"0px",width:g.width+"px",height:g.height+"px"}),Qc=null},999),Qc.exec.call(d,"ImageView","display",this.result.uid,width,height),g.destroy()}),a.transport(bI.atob(bV.substring(bV.indexOf("base64,")+7)),J,{required_caps:{display_media:!0},runtime_order:"flash,silverlight",container:Q})}}var Qc,d=this,U=b.extend({width:this.width,height:this.height,type:this.type||"image/jpeg",quality:90},ed);try{if(!(Q=J.get(Q)))throw new e.DOMException(e.DOMException.INVALID_NODE_TYPE_ERR);if(!this.size)throw new e.DOMException(e.DOMException.INVALID_STATE_ERR);this.width>a.MAX_RESIZE_WIDTH||this.height>a.MAX_RESIZE_HEIGHT;var bV=new a;return bV.bind("Resize",function(){g.call(this,U.type,U.quality)}),bV.bind("Load",function(){bV.downsize(U)}),this.meta.thumb&&this.meta.thumb.width>=U.width&&this.meta.thumb.height>=U.height?bV.load(this.meta.thumb.data):bV.clone(this,!1),bV}catch(b){this.trigger("error",b.code)}},destroy:function(){this.ruid&&(this.getRuntime().exec.call(this,"Image","destroy"),this.disconnectRuntime()),this.unbindAll()}}),this.handleEventProps(h),this.bind("Load Resize",function(){return Q.call(this)},999)}var h=["progress","load","error","resize","embedded"];return a.MAX_RESIZE_WIDTH=8192,a.MAX_RESIZE_HEIGHT=8192,a.prototype=d.instance,a}),Q("moxie/runtime/html5/Runtime",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/runtime/Runtime","moxie/core/utils/Env"],function(b,J,e,Q){function g(J){var g=this,A=e.capTest,d=e.capTrue,U=b.extend({access_binary:A(window.FileReader||window.File&&window.File.getAsDataURL),access_image_binary:function(){return g.can("access_binary")&&!!bc.Image},display_media:A((Q.can("create_canvas")||Q.can("use_data_uri_over32kb"))&&ed("moxie/image/Image")),do_cors:A(window.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest),drag_and_drop:A(function(){var b=document.createElement("div");return("draggable"in b||"ondragstart"in b&&"ondrop"in b)&&("IE"!==Q.browser||Q.verComp(Q.version,9,">"))}()),filter_by_extension:A(function(){return!("Chrome"===Q.browser&&Q.verComp(Q.version,28,"<")||"IE"===Q.browser&&Q.verComp(Q.version,10,"<")||"Safari"===Q.browser&&Q.verComp(Q.version,7,"<")||"Firefox"===Q.browser&&Q.verComp(Q.version,37,"<"))}()),return_response_headers:d,return_response_type:function(b){return"json"===b&&window.JSON?!0:Q.can("return_response_type",b)},return_status_code:d,report_upload_progress:A(window.XMLHttpRequest&&(new XMLHttpRequest).upload),resize_image:function(){return g.can("access_binary")&&Q.can("create_canvas")},select_file:function(){return Q.can("use_fileinput")&&window.File},select_folder:function(){return g.can("select_file")&&("Chrome"===Q.browser&&Q.verComp(Q.version,21,">=")||"Firefox"===Q.browser&&Q.verComp(Q.version,42,">="))},select_multiple:function(){return!(!g.can("select_file")||"Safari"===Q.browser&&"Windows"===Q.os||"iOS"===Q.os&&Q.verComp(Q.osVersion,"7.0.0",">")&&Q.verComp(Q.osVersion,"8.0.0","<"))},send_binary_string:A(window.XMLHttpRequest&&((new XMLHttpRequest).sendAsBinary||window.Uint8Array&&window.ArrayBuffer)),send_custom_headers:A(window.XMLHttpRequest),send_multipart:function(){return!!(window.XMLHttpRequest&&(new XMLHttpRequest).upload&&window.FormData)||g.can("send_binary_string")},slice_blob:A(window.File&&(File.prototype.mozSlice||File.prototype.webkitSlice||File.prototype.slice)),stream_upload:function(){return g.can("slice_blob")&&g.can("send_multipart")},summon_file_dialog:function(){return g.can("select_file")&&("Firefox"===Q.browser&&Q.verComp(Q.version,4,">=")||"Opera"===Q.browser&&Q.verComp(Q.version,12,">=")||"IE"===Q.browser&&Q.verComp(Q.version,10,">=")||!!~b.inArray(Q.browser,["Chrome","Safari","Edge"]))},upload_filesize:d,use_http_method:d},arguments[2]);e.call(this,J,arguments[1]||Qc,U),b.extend(this,{init:function(){this.trigger("Init")},destroy:function(b){return function(){b.call(g),b=g=null}}(this.destroy)}),b.extend(this.getShim(),bc)}var Qc="html5",bc={};return e.addConstructor(Qc,g),bc}),Q("moxie/runtime/html5/file/Blob",["moxie/runtime/html5/Runtime","moxie/file/Blob"],function(b,J){function e(){function b(b,J,e){var Q;if(!window.File.prototype.slice)return(Q=window.File.prototype.webkitSlice||window.File.prototype.mozSlice)?Q.call(b,J,e):null;try{return b.slice(),b.slice(J,e)}catch(Q){return b.slice(J,e-J)}}this.slice=function(){return new J(this.getRuntime().uid,b.apply(this,arguments))}}return b.Blob=e}),Q("moxie/core/utils/Events",["moxie/core/utils/Basic"],function(b){function J(){this.returnValue=!1}function e(){this.cancelBubble=!0}var Q={},ed="moxie_"+b.guid(),g=function(g,Qc,bc,A){var d,U;Qc=Qc.toLowerCase(),g.addEventListener?(d=bc,g.addEventListener(Qc,d,!1)):g.attachEvent&&(d=function(){var b=window.event;b.target||(b.target=b.srcElement),b.preventDefault=J,b.stopPropagation=e,bc(b)},g.attachEvent("on"+Qc,d)),g[ed]||(g[ed]=b.guid()),Q.hasOwnProperty(g[ed])||(Q[g[ed]]={}),U=Q[g[ed]],U.hasOwnProperty(Qc)||(U[Qc]=[]),U[Qc].push({func:d,orig:bc,key:A})},Qc=function(J,e,g){var Qc,bc;if(e=e.toLowerCase(),J[ed]&&Q[J[ed]]&&Q[J[ed]][e]){Qc=Q[J[ed]][e];for(var A=Qc.length-1;A>=0&&(Qc[A].orig!==g&&Qc[A].key!==g||(J.removeEventListener?J.removeEventListener(e,Qc[A].func,!1):J.detachEvent&&J.detachEvent("on"+e,Qc[A].func),Qc[A].orig=null,Qc[A].func=null,Qc.splice(A,1),g===bc));A--);if(Qc.length||delete Q[J[ed]][e],b.isEmptyObj(Q[J[ed]])){delete Q[J[ed]];try{delete J[ed]}catch(b){J[ed]=bc}}}},bc=function(J,e){J&&J[ed]&&b.each(Q[J[ed]],function(b,Q){Qc(J,Q,e)})};return{addEvent:g,removeEvent:Qc,removeAllEvents:bc}}),Q("moxie/runtime/html5/file/FileInput",["moxie/runtime/html5/Runtime","moxie/file/File","moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/utils/Events","moxie/core/utils/Mime","moxie/core/utils/Env"],function(b,J,e,Q,ed,g,Qc){function bc(){var b,bc;e.extend(this,{init:function(A){var d,U,bV,bI,a,h,c=this,N=c.getRuntime();b=A,bV=b.accept.mimes||g.extList2mimes(b.accept,N.can("filter_by_extension")),U=N.getShimContainer(),U.innerHTML='<input id="'+N.uid+'" type="file" style="font-size:999px;opacity:0;"'+(b.multiple&&N.can("select_multiple")?"multiple":"")+(b.directory&&N.can("select_folder")?"webkitdirectory directory":"")+(bV?' accept="'+bV.join(",")+'"':"")+" />",d=Q.get(N.uid),e.extend(d.style,{position:"absolute",top:0,left:0,width:"100%",height:"100%"}),bI=Q.get(b.browse_button),bc=Q.getStyle(bI,"z-index")||"auto",N.can("summon_file_dialog")&&("static"===Q.getStyle(bI,"position")&&(bI.style.position="relative"),ed.addEvent(bI,"click",function(b){var J=Q.get(N.uid);J&&!J.disabled&&J.click(),b.preventDefault()},c.uid),c.bind("Refresh",function(){a=parseInt(bc,10)||1,Q.get(b.browse_button).style.zIndex=a,this.getRuntime().getShimContainer().style.zIndex=a-1})),h=N.can("summon_file_dialog")?bI:U,ed.addEvent(h,"mouseover",function(){c.trigger("mouseenter")},c.uid),ed.addEvent(h,"mouseout",function(){c.trigger("mouseleave")},c.uid),ed.addEvent(h,"mousedown",function(){c.trigger("mousedown")},c.uid),ed.addEvent(Q.get(b.container),"mouseup",function(){c.trigger("mouseup")},c.uid),d.onchange=function Q(){if(c.files=[],e.each(this.files,function(e){var Q="";return b.directory&&"."==e.name?!0:(e.webkitRelativePath&&(Q="/"+e.webkitRelativePath.replace(/^\//,"")),e=new J(N.uid,e),e.relativePath=Q,c.files.push(e),void 0)}),"IE"!==Qc.browser&&"IEMobile"!==Qc.browser)this.value="";else{var ed=this.cloneNode(!0);this.parentNode.replaceChild(ed,this),ed.onchange=Q}c.files.length&&c.trigger("change")},c.trigger({type:"ready",async:!0}),U=null},setOption:function(b,J){var e=this.getRuntime(),ed=Q.get(e.uid);switch(b){case"accept":if(J){var Qc=J.mimes||g.extList2mimes(J,e.can("filter_by_extension"));ed.setAttribute("accept",Qc.join(","))}else ed.removeAttribute("accept");break;case"directory":J&&e.can("select_folder")?(ed.setAttribute("directory",""),ed.setAttribute("webkitdirectory","")):(ed.removeAttribute("directory"),ed.removeAttribute("webkitdirectory"));break;case"multiple":J&&e.can("select_multiple")?ed.setAttribute("multiple",""):ed.removeAttribute("multiple")}},disable:function(b){var J,e=this.getRuntime();(J=Q.get(e.uid))&&(J.disabled=!!b)},destroy:function(){var J=this.getRuntime(),e=J.getShim(),g=J.getShimContainer(),Qc=b&&Q.get(b.container),A=b&&Q.get(b.browse_button);Qc&&ed.removeAllEvents(Qc,this.uid),A&&(ed.removeAllEvents(A,this.uid),A.style.zIndex=bc),g&&(ed.removeAllEvents(g,this.uid),g.innerHTML=""),e.removeInstance(this.uid),b=g=Qc=A=e=null}})}return b.FileInput=bc}),Q("moxie/runtime/html5/file/FileDrop",["moxie/runtime/html5/Runtime","moxie/file/File","moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/utils/Events","moxie/core/utils/Mime"],function(b,J,e,Q,ed,g){function Qc(){function b(b){if(!b.dataTransfer||!b.dataTransfer.types)return!1;var J=e.toArray(b.dataTransfer.types||[]);return-1!==e.inArray("Files",J)||-1!==e.inArray("public.file-url",J)||-1!==e.inArray("application/x-moz-file",J)}function Qc(b,e){if(A(b)){var Q=new J(h,b);Q.relativePath=e||"",c.push(Q)}}function bc(b){for(var J=[],Q=0;Q<b.length;Q++)[].push.apply(J,b[Q].extensions.split(/\s*,\s*/));return-1===e.inArray("*",J)?J:[]}function A(b){if(!N.length)return!0;var J=g.getFileExtension(b.name);return!J||-1!==e.inArray(J,N)}function d(b,J){var Q=[];e.each(b,function(b){var J=b.webkitGetAsEntry();J&&(J.isFile?Qc(b.getAsFile(),J.fullPath):Q.push(J))}),Q.length?U(Q,J):J()}function U(b,J){var Q=[];e.each(b,function(b){Q.push(function(J){bV(b,J)})}),e.inSeries(Q,function(){J()})}function bV(b,J){b.isFile?b.file(function(e){Qc(e,b.fullPath),J()},function(){J()}):b.isDirectory?bI(b,J):J()}function bI(b,J){function e(b){ed.readEntries(function(J){J.length?([].push.apply(Q,J),e(b)):b()},b)}var Q=[],ed=b.createReader();e(function(){U(Q,J)})}var a,h,c=[],N=[];e.extend(this,{init:function(J){var Q,g=this;a=J,h=g.ruid,N=bc(a.accept),Q=a.container,ed.addEvent(Q,"dragover",function(J){b(J)&&(J.preventDefault(),J.dataTransfer.dropEffect="copy")},g.uid),ed.addEvent(Q,"drop",function(J){b(J)&&(J.preventDefault(),c=[],J.dataTransfer.items&&J.dataTransfer.items[0].webkitGetAsEntry?d(J.dataTransfer.items,function(){g.files=c,g.trigger("drop")}):(e.each(J.dataTransfer.files,function(b){Qc(b)}),g.files=c,g.trigger("drop")))},g.uid),ed.addEvent(Q,"dragenter",function(){g.trigger("dragenter")},g.uid),ed.addEvent(Q,"dragleave",function(){g.trigger("dragleave")},g.uid)},destroy:function(){ed.removeAllEvents(a&&Q.get(a.container),this.uid),h=c=N=a=null}})}return b.FileDrop=Qc}),Q("moxie/runtime/html5/file/FileReader",["moxie/runtime/html5/Runtime","moxie/core/utils/Encode","moxie/core/utils/Basic"],function(b,J,e){function Q(){function b(b){return J.atob(b.substring(b.indexOf("base64,")+7))}var Q,ed=!1;e.extend(this,{read:function(J,g){var Qc=this;Qc.result="",Q=new window.FileReader,Q.addEventListener("progress",function(b){Qc.trigger(b)}),Q.addEventListener("load",function(J){Qc.result=ed?b(Q.result):Q.result,Qc.trigger(J)}),Q.addEventListener("error",function(b){Qc.trigger(b,Q.error)}),Q.addEventListener("loadend",function(b){Q=null,Qc.trigger(b)}),"function"===e.typeOf(Q[J])?(ed=!1,Q[J](g.getSource())):"readAsBinaryString"===J&&(ed=!0,Q.readAsDataURL(g.getSource()))},abort:function(){Q&&Q.abort()},destroy:function(){Q=null}})}return b.FileReader=Q}),Q("moxie/runtime/html5/xhr/XMLHttpRequest",["moxie/runtime/html5/Runtime","moxie/core/utils/Basic","moxie/core/utils/Mime","moxie/core/utils/Url","moxie/file/File","moxie/file/Blob","moxie/xhr/FormData","moxie/core/Exceptions","moxie/core/utils/Env"],function(b,J,e,Q,ed,g,Qc,bc,A){function d(){function b(b,J){var e,Q,ed=this;e=J.getBlob().getSource(),Q=new window.FileReader,Q.onload=function(){J.append(J.getBlobName(),new g(null,{type:e.type,data:Q.result})),h.send.call(ed,b,J)},Q.readAsBinaryString(e)}function d(){return!window.XMLHttpRequest||"IE"===A.browser&&A.verComp(A.version,8,"<")?function(){for(var b=["Msxml2.XMLHTTP.6.0","Microsoft.XMLHTTP"],J=0;J<b.length;J++)try{return new ActiveXObject(b[J])}catch(b){}}():new window.XMLHttpRequest}function U(b){var J=b.responseXML,e=b.responseText;return"IE"===A.browser&&e&&J&&!J.documentElement&&/[^\/]+\/[^\+]+\+xml/.test(b.getResponseHeader("Content-Type"))&&(J=new window.ActiveXObject("Microsoft.XMLDOM"),J.async=!1,J.validateOnParse=!1,J.loadXML(e)),J&&("IE"===A.browser&&0!==J.parseError||!J.documentElement||"parsererror"===J.documentElement.tagName)?null:J}function bV(b){var J="----moxieboundary"+(new Date).getTime(),e="--",Q="\r\n",ed="",Qc=this.getRuntime();if(!Qc.can("send_binary_string"))throw new bc.RuntimeError(bc.RuntimeError.NOT_SUPPORTED_ERR);return bI.setRequestHeader("Content-Type","multipart/form-data; boundary="+J),b.each(function(b,Qc){ed+=b instanceof g?e+J+Q+'Content-Disposition: form-data; name="'+Qc+'"; filename="'+unescape(encodeURIComponent(b.name||"blob"))+'"'+Q+"Content-Type: "+(b.type||"application/octet-stream")+Q+Q+b.getSource()+Q:e+J+Q+'Content-Disposition: form-data; name="'+Qc+'"'+Q+Q+unescape(encodeURIComponent(b))+Q}),ed+=e+J+e+Q}var bI,a,h=this;J.extend(this,{send:function(e,ed){var bc=this,U="Mozilla"===A.browser&&A.verComp(A.version,4,">=")&&A.verComp(A.version,7,"<"),h="Android Browser"===A.browser,c=!1;if(a=e.url.replace(/^.+?\/([\w\-\.]+)$/,"$1").toLowerCase(),bI=d(),bI.open(e.method,e.url,e.async,e.user,e.password),ed instanceof g)ed.isDetached()&&(c=!0),ed=ed.getSource();else if(ed instanceof Qc){if(ed.hasBlob())if(ed.getBlob().isDetached())ed=bV.call(bc,ed),c=!0;else if((U||h)&&"blob"===J.typeOf(ed.getBlob().getSource())&&window.FileReader)return b.call(bc,e,ed),void 0;if(ed instanceof Qc){var N=new window.FormData;ed.each(function(b,J){b instanceof g?N.append(J,b.getSource()):N.append(J,b)}),ed=N}}bI.upload?(e.withCredentials&&(bI.withCredentials=!0),bI.addEventListener("load",function(b){bc.trigger(b)}),bI.addEventListener("error",function(b){bc.trigger(b)}),bI.addEventListener("progress",function(b){bc.trigger(b)}),bI.upload.addEventListener("progress",function(b){bc.trigger({type:"UploadProgress",loaded:b.loaded,total:b.total})})):bI.onreadystatechange=function(){switch(bI.readyState){case 1:break;case 2:break;case 3:var b,J;try{Q.hasSameOrigin(e.url)&&(b=bI.getResponseHeader("Content-Length")||0),bI.responseText&&(J=bI.responseText.length)}catch(e){b=J=0}bc.trigger({type:"progress",lengthComputable:!!b,total:parseInt(b,10),loaded:J});break;case 4:bI.onreadystatechange=function(){},0===bI.status?bc.trigger("error"):bc.trigger("load")}},J.isEmptyObj(e.headers)||J.each(e.headers,function(b,J){bI.setRequestHeader(J,b)}),""!==e.responseType&&"responseType"in bI&&(bI.responseType="json"!==e.responseType||A.can("return_response_type","json")?e.responseType:"text"),c?bI.sendAsBinary?bI.sendAsBinary(ed):function(){for(var b=new Uint8Array(ed.length),J=0;J<ed.length;J++)b[J]=255&ed.charCodeAt(J);bI.send(b.buffer)}():bI.send(ed),bc.trigger("loadstart")},getStatus:function(){try{if(bI)return bI.status}catch(b){}return 0},getResponse:function(b){var J=this.getRuntime();try{switch(b){case"blob":var Q=new ed(J.uid,bI.response),g=bI.getResponseHeader("Content-Disposition");if(g){var Qc=g.match(/filename=([\'\"'])([^\1]+)\1/);Qc&&(a=Qc[2])}return Q.name=a,Q.type||(Q.type=e.getFileMime(a)),Q;case"json":return A.can("return_response_type","json")?bI.response:200===bI.status&&window.JSON?JSON.parse(bI.responseText):null;case"document":return U(bI);default:return""!==bI.responseText?bI.responseText:null}}catch(b){return null}},getAllResponseHeaders:function(){try{return bI.getAllResponseHeaders()}catch(b){}return""},abort:function(){bI&&bI.abort()},destroy:function(){h=a=null}})}return b.XMLHttpRequest=d}),Q("moxie/runtime/html5/utils/BinaryReader",["moxie/core/utils/Basic"],function(b){function J(b){b instanceof ArrayBuffer?e.apply(this,arguments):Q.apply(this,arguments)}function e(J){var e=new DataView(J);b.extend(this,{readByteAt:function(b){return e.getUint8(b)},writeByteAt:function(b,J){e.setUint8(b,J)},SEGMENT:function(b,Q,ed){switch(arguments.length){case 2:return J.slice(b,b+Q);case 1:return J.slice(b);case 3:if(null===ed&&(ed=new ArrayBuffer),ed instanceof ArrayBuffer){var g=new Uint8Array(this.length()-Q+ed.byteLength);b>0&&g.set(new Uint8Array(J.slice(0,b)),0),g.set(new Uint8Array(ed),b),g.set(new Uint8Array(J.slice(b+Q)),b+ed.byteLength),this.clear(),J=g.buffer,e=new DataView(J);break}default:return J}},length:function(){return J?J.byteLength:0},clear:function(){e=J=null}})}function Q(J){function e(b,e,Q){Q=3===arguments.length?Q:J.length-e-1,J=J.substr(0,e)+b+J.substr(Q+e)}b.extend(this,{readByteAt:function(b){return J.charCodeAt(b)},writeByteAt:function(b,J){e(String.fromCharCode(J),b,1)},SEGMENT:function(b,Q,ed){switch(arguments.length){case 1:return J.substr(b);case 2:return J.substr(b,Q);case 3:e(null!==ed?ed:"",b,Q);break;default:return J}},length:function(){return J?J.length:0},clear:function(){J=null}})}return b.extend(J.prototype,{littleEndian:!1,read:function(b,J){var e,Q,ed;if(b+J>this.length())throw new Error("You are trying to read outside the source boundaries.");for(Q=this.littleEndian?0:-8*(J-1),ed=0,e=0;J>ed;ed++)e|=this.readByteAt(b+ed)<<Math.abs(Q+8*ed);return e},write:function(b,J,e){var Q,ed;if(b>this.length())throw new Error("You are trying to write outside the source boundaries.");for(Q=this.littleEndian?0:-8*(e-1),ed=0;e>ed;ed++)this.writeByteAt(b+ed,255&J>>Math.abs(Q+8*ed))},BYTE:function(b){return this.read(b,1)},SHORT:function(b){return this.read(b,2)},LONG:function(b){return this.read(b,4)},SLONG:function(b){var J=this.read(b,4);return J>2147483647?J-4294967296:J},CHAR:function(b){return String.fromCharCode(this.read(b,1))},STRING:function(b,J){return this.asArray("CHAR",b,J).join("")},asArray:function(b,J,e){for(var Q=[],ed=0;e>ed;ed++)Q[ed]=this[b](J+ed);return Q}}),J}),Q("moxie/runtime/html5/image/JPEGHeaders",["moxie/runtime/html5/utils/BinaryReader","moxie/core/Exceptions"],function(b,J){return function e(Q){var ed,g,Qc,bc=[],A=0;if(ed=new b(Q),65496!==ed.SHORT(0))throw ed.clear(),new J.ImageError(J.ImageError.WRONG_FORMAT);for(g=2;g<=ed.length();)if(Qc=ed.SHORT(g),Qc>=65488&&65495>=Qc)g+=2;else{if(65498===Qc||65497===Qc)break;A=ed.SHORT(g+2)+2,Qc>=65505&&65519>=Qc&&bc.push({hex:Qc,name:"APP"+(15&Qc),start:g,length:A,segment:ed.SEGMENT(g,A)}),g+=A}return ed.clear(),{headers:bc,restore:function(J){var e,Q,ed;for(ed=new b(J),g=65504==ed.SHORT(2)?4+ed.SHORT(4):2,Q=0,e=bc.length;e>Q;Q++)ed.SEGMENT(g,0,bc[Q].segment),g+=bc[Q].length;return J=ed.SEGMENT(),ed.clear(),J},strip:function(J){var Q,ed,g,Qc;for(g=new e(J),ed=g.headers,g.purge(),Q=new b(J),Qc=ed.length;Qc--;)Q.SEGMENT(ed[Qc].start,ed[Qc].length,"");return J=Q.SEGMENT(),Q.clear(),J},get:function(b){for(var J=[],e=0,Q=bc.length;Q>e;e++)bc[e].name===b.toUpperCase()&&J.push(bc[e].segment);return J},set:function(b,J){var e,Q,ed,g=[];for("string"==typeof J?g.push(J):g=J,e=Q=0,ed=bc.length;ed>e&&(bc[e].name===b.toUpperCase()&&(bc[e].segment=g[Q],bc[e].length=g[Q].length,Q++),!(Q>=g.length));e++);},purge:function(){this.headers=bc=[]}}}}),Q("moxie/runtime/html5/image/ExifParser",["moxie/core/utils/Basic","moxie/runtime/html5/utils/BinaryReader","moxie/core/Exceptions"],function(b,e,Q){function ed(g){function Qc(e,ed){var g,Qc,bc,A,d,bI,a,h,c=this,N=[],bb={},ee={1:"BYTE",7:"UNDEFINED",2:"ASCII",3:"SHORT",4:"LONG",5:"RATIONAL",9:"SLONG",10:"SRATIONAL"},de={BYTE:1,UNDEFINED:1,ASCII:1,SHORT:2,LONG:4,RATIONAL:8,SLONG:4,SRATIONAL:8};for(g=c.SHORT(e),Qc=0;g>Qc;Qc++)if(N=[],a=e+2+12*Qc,bc=ed[c.SHORT(a)],bc!==J){if(A=ee[c.SHORT(a+=2)],d=c.LONG(a+=2),bI=de[A],!bI)throw new Q.ImageError(Q.ImageError.INVALID_META_ERR);if(a+=4,bI*d>4&&(a=c.LONG(a)+bV.tiffHeader),a+bI*d>=this.length())throw new Q.ImageError(Q.ImageError.INVALID_META_ERR);"ASCII"!==A?(N=c.asArray(A,a,d),h=1==d?N[0]:N,bb[bc]=U.hasOwnProperty(bc)&&"object"!=typeof h?U[bc][h]:h):bb[bc]=b.trim(c.STRING(a,d).replace(/\0$/,""))}return bb}function bc(b,J,e){var Q,ed,g,Qc=0;if("string"==typeof J){var bc=d[b.toLowerCase()];for(var A in bc)if(bc[A]===J){J=A;break}}Q=bV[b.toLowerCase()+"IFD"],ed=this.SHORT(Q);for(var U=0;ed>U;U++)if(g=Q+12*U+2,this.SHORT(g)==J){Qc=g+8;break}if(!Qc)return!1;try{this.write(Qc,e,4)}catch(b){return!1}return!0}var A,d,U,bV,bI,a;if(e.call(this,g),d={tiff:{274:"Orientation",270:"ImageDescription",271:"Make",272:"Model",305:"Software",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer"},exif:{36864:"ExifVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",36867:"DateTimeOriginal",33434:"ExposureTime",33437:"FNumber",34855:"ISOSpeedRatings",37377:"ShutterSpeedValue",37378:"ApertureValue",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37386:"FocalLength",41986:"ExposureMode",41987:"WhiteBalance",41990:"SceneCaptureType",41988:"DigitalZoomRatio",41992:"Contrast",41993:"Saturation",41994:"Sharpness"},gps:{0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude"},thumb:{513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength"}},U={ColorSpace:{1:"sRGB",0:"Uncalibrated"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{1:"Daylight",2:"Fliorescent",3:"Tungsten",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 -5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},ExposureMode:{0:"Auto exposure",1:"Manual exposure",2:"Auto bracket"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},GPSLatitudeRef:{N:"North latitude",S:"South latitude"},GPSLongitudeRef:{E:"East longitude",W:"West longitude"}},bV={tiffHeader:10},bI=bV.tiffHeader,A={clear:this.clear},b.extend(this,{read:function(){try{return ed.prototype.read.apply(this,arguments)}catch(b){throw new Q.ImageError(Q.ImageError.INVALID_META_ERR)}},write:function(){try{return ed.prototype.write.apply(this,arguments)}catch(b){throw new Q.ImageError(Q.ImageError.INVALID_META_ERR)}},UNDEFINED:function(){return this.BYTE.apply(this,arguments)},RATIONAL:function(b){return this.LONG(b)/this.LONG(b+4)},SRATIONAL:function(b){return this.SLONG(b)/this.SLONG(b+4)},ASCII:function(b){return this.CHAR(b)},TIFF:function(){return a||null},EXIF:function(){var J=null;if(bV.exifIFD){try{J=Qc.call(this,bV.exifIFD,d.exif)}catch(b){return null}if(J.ExifVersion&&"array"===b.typeOf(J.ExifVersion)){for(var e=0,Q="";e<J.ExifVersion.length;e++)Q+=String.fromCharCode(J.ExifVersion[e]);J.ExifVersion=Q}}return J},GPS:function(){var J=null;if(bV.gpsIFD){try{J=Qc.call(this,bV.gpsIFD,d.gps)}catch(b){return null}J.GPSVersionID&&"array"===b.typeOf(J.GPSVersionID)&&(J.GPSVersionID=J.GPSVersionID.join("."))}return J},thumb:function(){if(bV.IFD1)try{var b=Qc.call(this,bV.IFD1,d.thumb);if("JPEGInterchangeFormat"in b)return this.SEGMENT(bV.tiffHeader+b.JPEGInterchangeFormat,b.JPEGInterchangeFormatLength)}catch(b){}return null},setExif:function(b,J){return"PixelXDimension"!==b&&"PixelYDimension"!==b?!1:bc.call(this,"exif",b,J)},clear:function(){A.clear(),g=d=U=a=bV=A=null}}),65505!==this.SHORT(0)||"EXIF\0"!==this.STRING(4,5).toUpperCase())throw new Q.ImageError(Q.ImageError.INVALID_META_ERR);if(this.littleEndian=18761==this.SHORT(bI),42!==this.SHORT(bI+=2))throw new Q.ImageError(Q.ImageError.INVALID_META_ERR);bV.IFD0=bV.tiffHeader+this.LONG(bI+=2),a=Qc.call(this,bV.IFD0,d.tiff),"ExifIFDPointer"in a&&(bV.exifIFD=bV.tiffHeader+a.ExifIFDPointer,delete a.ExifIFDPointer),"GPSInfoIFDPointer"in a&&(bV.gpsIFD=bV.tiffHeader+a.GPSInfoIFDPointer,delete a.GPSInfoIFDPointer),b.isEmptyObj(a)&&(a=null);var h=this.LONG(bV.IFD0+12*this.SHORT(bV.IFD0)+2);h&&(bV.IFD1=bV.tiffHeader+h)}return ed.prototype=e.prototype,ed}),Q("moxie/runtime/html5/image/JPEG",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/runtime/html5/image/JPEGHeaders","moxie/runtime/html5/utils/BinaryReader","moxie/runtime/html5/image/ExifParser"],function(b,J,e,Q,ed){function g(g){function Qc(b){var J,e,Q=0;for(b||(b=d);Q<=b.length();){if(J=b.SHORT(Q+=2),J>=65472&&65475>=J)return Q+=5,{height:b.SHORT(Q),width:b.SHORT(Q+=2)};e=b.SHORT(Q+=2),Q+=e-2}return null}function bc(){var b,J,e=bV.thumb();return e&&(b=new Q(e),J=Qc(b),b.clear(),J)?(J.data=e,J):null}function A(){bV&&U&&d&&(bV.clear(),U.purge(),d.clear(),bI=U=bV=d=null)}var d,U,bV,bI;if(d=new Q(g),65496!==d.SHORT(0))throw new J.ImageError(J.ImageError.WRONG_FORMAT);U=new e(g);try{bV=new ed(U.get("app1")[0])}catch(b){}bI=Qc.call(this),b.extend(this,{type:"image/jpeg",size:d.length(),width:bI&&bI.width||0,height:bI&&bI.height||0,setExif:function(J,e){return bV?("object"===b.typeOf(J)?b.each(J,function(b,J){bV.setExif(J,b)}):bV.setExif(J,e),U.set("app1",bV.SEGMENT()),void 0):!1},writeHeaders:function(){return arguments.length?U.restore(arguments[0]):U.restore(g)},stripHeaders:function(b){return U.strip(b)},purge:function(){A.call(this)}}),bV&&(this.meta={tiff:bV.TIFF(),exif:bV.EXIF(),gps:bV.GPS(),thumb:bc()})}return g}),Q("moxie/runtime/html5/image/PNG",["moxie/core/Exceptions","moxie/core/utils/Basic","moxie/runtime/html5/utils/BinaryReader"],function(b,J,e){function Q(Q){function ed(){var b,J;return b=Qc.call(this,8),"IHDR"==b.type?(J=b.start,{width:bc.LONG(J),height:bc.LONG(J+=4)}):null}function g(){bc&&(bc.clear(),Q=U=A=d=bc=null)}function Qc(b){var J,e,Q,ed;return J=bc.LONG(b),e=bc.STRING(b+=4,4),Q=b+=4,ed=bc.LONG(b+J),{length:J,type:e,start:Q,CRC:ed}}var bc,A,d,U;bc=new e(Q),function(){var J=0,e=0,Q=[35152,20039,3338,6666];for(e=0;e<Q.length;e++,J+=2)if(Q[e]!=bc.SHORT(J))throw new b.ImageError(b.ImageError.WRONG_FORMAT)}(),U=ed.call(this),J.extend(this,{type:"image/png",size:bc.length(),width:U.width,height:U.height,purge:function(){g.call(this)}}),g.call(this)}return Q}),Q("moxie/runtime/html5/image/ImageInfo",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/runtime/html5/image/JPEG","moxie/runtime/html5/image/PNG"],function(b,J,e,Q){return function(ed){var g,Qc=[e,Q];g=function(){for(var b=0;b<Qc.length;b++)try{return new Qc[b](ed)}catch(b){}throw new J.ImageError(J.ImageError.WRONG_FORMAT)}(),b.extend(this,{type:"",size:0,width:0,height:0,setExif:function(){},writeHeaders:function(b){return b},stripHeaders:function(b){return b},purge:function(){ed=null}}),b.extend(this,g),this.purge=function(){g.purge(),g=null}}}),Q("moxie/runtime/html5/image/ResizerCanvas",[],function(){function b(e,Q){var ed=e.width,g=Math.floor(ed*Q),Qc=!1;(.5>Q||Q>2)&&(Q=.5>Q?.5:2,Qc=!0);var bc=J(e,Q);return Qc?b(bc,g/bc.width):bc}function J(b,J){var e=b.width,Q=b.height,ed=Math.floor(e*J),g=Math.floor(Q*J),Qc=document.createElement("canvas");return Qc.width=ed,Qc.height=g,Qc.getContext("2d").drawImage(b,0,0,e,Q,0,0,ed,g),b=null,Qc}return{scale:b}}),Q("moxie/runtime/html5/image/Image",["moxie/runtime/html5/Runtime","moxie/core/utils/Basic","moxie/core/Exceptions","moxie/core/utils/Encode","moxie/file/Blob","moxie/file/File","moxie/runtime/html5/image/ImageInfo","moxie/runtime/html5/image/ResizerCanvas","moxie/core/utils/Mime","moxie/core/utils/Env"],function(b,J,e,Q,ed,g,Qc,bc,A){function d(){function b(){if(!ee&&!N)throw new e.ImageError(e.DOMException.INVALID_STATE_ERR);return ee||N}function d(){var J=b();return"canvas"==J.nodeName.toLowerCase()?J:(ee=document.createElement("canvas"),ee.width=J.width,ee.height=J.height,ee.getContext("2d").drawImage(J,0,0),ee)}function U(b){return Q.atob(b.substring(b.indexOf("base64,")+7))}function bV(b,J){return"data:"+(J||"")+";base64,"+Q.btoa(b)}function bI(b){var J=this;N=new Image,N.onerror=function(){c.call(this),J.trigger("error",e.ImageError.WRONG_FORMAT)},N.onload=function(){J.trigger("load")},N.src="data:"==b.substr(0,5)?b:bV(b,gS.type)}function a(b,J){var Q,ed=this;return window.FileReader?(Q=new FileReader,Q.onload=function(){J(this.result)},Q.onerror=function(){ed.trigger("error",e.ImageError.WRONG_FORMAT)},Q.readAsDataURL(b),void 0):J(b.getAsDataURL())}function h(b,e){var Q=Math.PI/180,ed=document.createElement("canvas"),g=ed.getContext("2d"),Qc=b.width,bc=b.height;switch(J.inArray(e,[5,6,7,8])>-1?(ed.width=bc,ed.height=Qc):(ed.width=Qc,ed.height=bc),e){case 2:g.translate(Qc,0),g.scale(-1,1);break;case 3:g.translate(Qc,bc),g.rotate(180*Q);break;case 4:g.translate(0,bc),g.scale(1,-1);break;case 5:g.rotate(90*Q),g.scale(1,-1);break;case 6:g.rotate(90*Q),g.translate(0,-bc);break;case 7:g.rotate(90*Q),g.translate(Qc,-bc),g.scale(-1,1);break;case 8:g.rotate(-90*Q),g.translate(-Qc,0)}return g.drawImage(b,0,0,Qc,bc),ed}function c(){bb&&(bb.purge(),bb=null),de=N=ee=gS=null,gE=!1}var N,bb,ee,de,gS,aH=this,gE=!1,gc=!0;J.extend(this,{loadFromBlob:function(b){var J=this,Q=J.getRuntime(),ed=arguments.length>1?arguments[1]:!0;if(!Q.can("access_binary"))throw new e.RuntimeError(e.RuntimeError.NOT_SUPPORTED_ERR);return gS=b,b.isDetached()?(de=b.getSource(),bI.call(this,de),void 0):(a.call(this,b.getSource(),function(b){ed&&(de=U(b)),bI.call(J,b)}),void 0)},loadFromImage:function(b,J){this.meta=b.meta,gS=new g(null,{name:b.name,size:b.size,type:b.type}),bI.call(this,J?de=b.getAsBinaryString():b.getAsDataURL())},getInfo:function(){var J,e=this.getRuntime();return!bb&&de&&e.can("access_image_binary")&&(bb=new Qc(de)),J={width:b().width||0,height:b().height||0,type:gS.type||A.getFileMime(gS.name),size:de&&de.length||gS.size||0,name:gS.name||"",meta:null},gc&&(J.meta=bb&&bb.meta||this.meta||{},!J.meta||!J.meta.thumb||J.meta.thumb.data instanceof ed||(J.meta.thumb.data=new ed(null,{type:"image/jpeg",data:J.meta.thumb.data}))),J},resize:function(J,e,Q){var ed=document.createElement("canvas");if(ed.width=J.width,ed.height=J.height,ed.getContext("2d").drawImage(b(),J.x,J.y,J.width,J.height,0,0,ed.width,ed.height),ee=bc.scale(ed,e),gc=Q.preserveHeaders,!gc){var g=this.meta&&this.meta.tiff&&this.meta.tiff.Orientation||1;ee=h(ee,g)}this.width=ee.width,this.height=ee.height,gE=!0,this.trigger("Resize")},getAsCanvas:function(){return ee||(ee=d()),ee.id=this.uid+"_canvas",ee},getAsBlob:function(b,J){return b!==this.type?(gE=!0,new g(null,{name:gS.name||"",type:b,data:aH.getAsDataURL(b,J)})):new g(null,{name:gS.name||"",type:b,data:aH.getAsBinaryString(b,J)})},getAsDataURL:function(b){var J=arguments[1]||90;if(!gE)return N.src;if(d(),"image/jpeg"!==b)return ee.toDataURL("image/png");try{return ee.toDataURL("image/jpeg",J/100)}catch(b){return ee.toDataURL("image/jpeg")}},getAsBinaryString:function(b,J){if(!gE)return de||(de=U(aH.getAsDataURL(b,J))),de;if("image/jpeg"!==b)de=U(aH.getAsDataURL(b,J));else{var e;J||(J=90),d();try{e=ee.toDataURL("image/jpeg",J/100)}catch(b){e=ee.toDataURL("image/jpeg")}de=U(e),bb&&(de=bb.stripHeaders(de),gc&&(bb.meta&&bb.meta.exif&&bb.setExif({PixelXDimension:this.width,PixelYDimension:this.height}),de=bb.writeHeaders(de)),bb.purge(),bb=null)}return gE=!1,de},destroy:function(){aH=null,c.call(this),this.getRuntime().getShim().removeInstance(this.uid)}})}return b.Image=d}),Q("moxie/runtime/flash/Runtime",["moxie/core/utils/Basic","moxie/core/utils/Env","moxie/core/utils/Dom","moxie/core/Exceptions","moxie/runtime/Runtime"],function(b,J,e,Q,g){function Qc(){var b;try{b=navigator.plugins["Shockwave Flash"],b=b.description}catch(J){try{b=new ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version")}catch(J){b="0.0"}}return b=b.match(/\d+/g),parseFloat(b[0]+"."+b[1])}function bc(b){var Q=e.get(b);Q&&"OBJECT"==Q.nodeName&&("IE"===J.browser?(Q.style.display="none",function J(){4==Q.readyState?A(b):setTimeout(J,10)}()):Q.parentNode.removeChild(Q))}function A(b){var J=e.get(b);if(J){for(var Q in J)"function"==typeof J[Q]&&(J[Q]=null);J.parentNode.removeChild(J)}}function d(A){var d,bI=this;A=b.extend({swf_url:J.swf_url},A),g.call(this,A,U,{access_binary:function(b){return b&&"browser"===bI.mode},access_image_binary:function(b){return b&&"browser"===bI.mode},display_media:g.capTest(ed("moxie/image/Image")),do_cors:g.capTrue,drag_and_drop:!1,report_upload_progress:function(){return"client"===bI.mode},resize_image:g.capTrue,return_response_headers:!1,return_response_type:function(J){return"json"===J&&window.JSON?!0:!b.arrayDiff(J,["","text","document"])||"browser"===bI.mode},return_status_code:function(J){return"browser"===bI.mode||!b.arrayDiff(J,[200,404])},select_file:g.capTrue,select_multiple:g.capTrue,send_binary_string:function(b){return b&&"browser"===bI.mode},send_browser_cookies:function(b){return b&&"browser"===bI.mode},send_custom_headers:function(b){return b&&"browser"===bI.mode},send_multipart:g.capTrue,slice_blob:function(b){return b&&"browser"===bI.mode},stream_upload:function(b){return b&&"browser"===bI.mode},summon_file_dialog:!1,upload_filesize:function(J){return b.parseSizeStr(J)<=2097152||"client"===bI.mode},use_http_method:function(J){return!b.arrayDiff(J,["GET","POST"])}},{access_binary:function(b){return b?"browser":"client"},access_image_binary:function(b){return b?"browser":"client"},report_upload_progress:function(b){return b?"browser":"client"},return_response_type:function(J){return b.arrayDiff(J,["","text","json","document"])?"browser":["client","browser"]},return_status_code:function(J){return b.arrayDiff(J,[200,404])?"browser":["client","browser"]},send_binary_string:function(b){return b?"browser":"client"},send_browser_cookies:function(b){return b?"browser":"client"},send_custom_headers:function(b){return b?"browser":"client"},slice_blob:function(b){return b?"browser":"client"},stream_upload:function(b){return b?"client":"browser"},upload_filesize:function(J){return b.parseSizeStr(J)>=2097152?"client":"browser"}},"client"),Qc()<11.3&&(this.mode=!1),b.extend(this,{getShim:function(){return e.get(this.uid)},shimExec:function(b,J){var e=[].slice.call(arguments,2);return bI.getShim().exec(this.uid,b,J,e)},init:function(){var e,ed,g;g=this.getShimContainer(),b.extend(g.style,{position:"absolute",top:"-8px",left:"-8px",width:"9px",height:"9px",overflow:"hidden"}),e='<object id="'+this.uid+'" type="application/x-shockwave-flash" data="'+A.swf_url+'" ',"IE"===J.browser&&(e+='classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" '),e+='width="100%" height="100%" style="outline:0"><param name="movie" value="'+A.swf_url+'" />'+'<param name="flashvars" value="uid='+escape(this.uid)+"&target="+J.global_event_dispatcher+'" />'+'<param name="wmode" value="transparent" />'+'<param name="allowscriptaccess" value="always" />'+"</object>","IE"===J.browser?(ed=document.createElement("div"),g.appendChild(ed),ed.outerHTML=e,ed=g=null):g.innerHTML=e,d=setTimeout(function(){bI&&!bI.initialized&&bI.trigger("Error",new Q.RuntimeError(Q.RuntimeError.NOT_INIT_ERR))},5e3)},destroy:function(b){return function(){bc(bI.uid),b.call(bI),clearTimeout(d),A=d=b=bI=null}}(this.destroy)},bV)}var U="flash",bV={};return g.addConstructor(U,d),bV}),Q("moxie/runtime/flash/file/Blob",["moxie/runtime/flash/Runtime","moxie/file/Blob"],function(b,J){var e={slice:function(b,e,Q,ed){var g=this.getRuntime();return 0>e?e=Math.max(b.size+e,0):e>0&&(e=Math.min(e,b.size)),0>Q?Q=Math.max(b.size+Q,0):Q>0&&(Q=Math.min(Q,b.size)),b=g.shimExec.call(this,"Blob","slice",e,Q,ed||""),b&&(b=new J(g.uid,b)),b}};return b.Blob=e}),Q("moxie/runtime/flash/file/FileInput",["moxie/runtime/flash/Runtime","moxie/file/File","moxie/core/utils/Basic"],function(b,J,e){var Q={init:function(b){var Q=this,ed=this.getRuntime();this.bind("Change",function(){var b=ed.shimExec.call(Q,"FileInput","getFiles");Q.files=[],e.each(b,function(b){Q.files.push(new J(ed.uid,b))})},999),this.getRuntime().shimExec.call(this,"FileInput","init",{accept:b.accept,multiple:b.multiple}),this.trigger("ready")}};return b.FileInput=Q}),Q("moxie/runtime/flash/file/FileReader",["moxie/runtime/flash/Runtime","moxie/core/utils/Encode"],function(b,J){function e(b,e){switch(e){case"readAsText":return J.atob(b,"utf8");case"readAsBinaryString":return J.atob(b);case"readAsDataURL":return b}return null}var Q={read:function(b,J){var Q=this;return Q.result="","readAsDataURL"===b&&(Q.result="data:"+(J.type||"")+";base64,"),Q.bind("Progress",function(J,ed){ed&&(Q.result+=e(ed,b))},999),Q.getRuntime().shimExec.call(this,"FileReader","readAsBase64",J.uid)}};return b.FileReader=Q}),Q("moxie/runtime/flash/file/FileReaderSync",["moxie/runtime/flash/Runtime","moxie/core/utils/Encode"],function(b,J){function e(b,e){switch(e){case"readAsText":return J.atob(b,"utf8");case"readAsBinaryString":return J.atob(b);case"readAsDataURL":return b}return null}var Q={read:function(b,J){var Q,ed=this.getRuntime();return(Q=ed.shimExec.call(this,"FileReaderSync","readAsBase64",J.uid))?("readAsDataURL"===b&&(Q="data:"+(J.type||"")+";base64,"+Q),e(Q,b,J.type)):null}};return b.FileReaderSync=Q}),Q("moxie/runtime/flash/runtime/Transporter",["moxie/runtime/flash/Runtime","moxie/file/Blob"],function(b,J){var e={getAsBlob:function(b){var e=this.getRuntime(),Q=e.shimExec.call(this,"Transporter","getAsBlob",b);return Q?new J(e.uid,Q):null}};return b.Transporter=e}),Q("moxie/runtime/flash/xhr/XMLHttpRequest",["moxie/runtime/flash/Runtime","moxie/core/utils/Basic","moxie/file/Blob","moxie/file/File","moxie/file/FileReaderSync","moxie/runtime/flash/file/FileReaderSync","moxie/xhr/FormData","moxie/runtime/Transporter","moxie/runtime/flash/runtime/Transporter"],function(b,J,e,Q,ed,g,Qc,bc){var A={send:function(b,Q){function ed(){b.transport=U.mode,U.shimExec.call(d,"XMLHttpRequest","send",b,Q)}function g(b,J){U.shimExec.call(d,"XMLHttpRequest","appendBlob",b,J.uid),Q=null,ed()}function A(b,J){var e=new bc;e.bind("TransportingComplete",function(){J(this.result)}),e.transport(b.getSource(),b.type,{ruid:U.uid})}var d=this,U=d.getRuntime();if(J.isEmptyObj(b.headers)||J.each(b.headers,function(b,J){U.shimExec.call(d,"XMLHttpRequest","setRequestHeader",J,b.toString())}),Q instanceof Qc){var bV;if(Q.each(function(b,J){b instanceof e?bV=J:U.shimExec.call(d,"XMLHttpRequest","append",J,b)}),Q.hasBlob()){var bI=Q.getBlob();bI.isDetached()?A(bI,function(b){bI.destroy(),g(bV,b)}):g(bV,bI)}else Q=null,ed()}else Q instanceof e?Q.isDetached()?A(Q,function(b){Q.destroy(),Q=b.uid,ed()}):(Q=Q.uid,ed()):ed()},getResponse:function(b){var e,g,Qc=this.getRuntime();if(g=Qc.shimExec.call(this,"XMLHttpRequest","getResponseAsBlob")){if(g=new Q(Qc.uid,g),"blob"===b)return g;try{if(e=new ed,~J.inArray(b,["","text"]))return e.readAsText(g);if("json"===b&&window.JSON)return JSON.parse(e.readAsText(g))}finally{g.destroy()}}return null},abort:function(){var b=this.getRuntime();b.shimExec.call(this,"XMLHttpRequest","abort"),this.dispatchEvent("readystatechange"),this.dispatchEvent("abort")}};return b.XMLHttpRequest=A}),Q("moxie/runtime/flash/image/Image",["moxie/runtime/flash/Runtime","moxie/core/utils/Basic","moxie/runtime/Transporter","moxie/file/Blob","moxie/file/FileReaderSync"],function(b,J,e,Q,ed){var g={loadFromBlob:function(b){function J(b){ed.shimExec.call(Q,"Image","loadFromBlob",b.uid),Q=ed=null}var Q=this,ed=Q.getRuntime();if(b.isDetached()){var g=new e;g.bind("TransportingComplete",function(){J(g.result.getSource())}),g.transport(b.getSource(),b.type,{ruid:ed.uid})}else J(b.getSource())},loadFromImage:function(b){var J=this.getRuntime();return J.shimExec.call(this,"Image","loadFromImage",b.uid)},getInfo:function(){var b=this.getRuntime(),J=b.shimExec.call(this,"Image","getInfo");return!J.meta||!J.meta.thumb||J.meta.thumb.data instanceof Q||(J.meta.thumb.data=new Q(b.uid,J.meta.thumb.data)),J},getAsBlob:function(b,J){var e=this.getRuntime(),ed=e.shimExec.call(this,"Image","getAsBlob",b,J);return ed?new Q(e.uid,ed):null},getAsDataURL:function(){var b,J=this.getRuntime(),e=J.Image.getAsBlob.apply(this,arguments);return e?(b=new ed,b.readAsDataURL(e)):null}};return b.Image=g}),Q("moxie/runtime/silverlight/Runtime",["moxie/core/utils/Basic","moxie/core/utils/Env","moxie/core/utils/Dom","moxie/core/Exceptions","moxie/runtime/Runtime"],function(b,J,e,Q,g){function Qc(b){var J,e,Q,ed,g,Qc=!1,bc=null,A=0;try{try{bc=new ActiveXObject("AgControl.AgControl"),bc.IsVersionSupported(b)&&(Qc=!0),bc=null}catch(bc){var d=navigator.plugins["Silverlight Plug-In"];if(d){for(J=d.description,"1.0.30226.2"===J&&(J="2.0.30226.2"),e=J.split(".");e.length>3;)e.pop();for(;e.length<4;)e.push(0);for(Q=b.split(".");Q.length>4;)Q.pop();do{ed=parseInt(Q[A],10),g=parseInt(e[A],10),A++}while(A<Q.length&&ed===g);g>=ed&&!isNaN(ed)&&(Qc=!0)}}}catch(b){Qc=!1}return Qc}function bc(bc){var U,bV=this;bc=b.extend({xap_url:J.xap_url},bc),g.call(this,bc,A,{access_binary:g.capTrue,access_image_binary:g.capTrue,display_media:g.capTest(ed("moxie/image/Image")),do_cors:g.capTrue,drag_and_drop:!1,report_upload_progress:g.capTrue,resize_image:g.capTrue,return_response_headers:function(b){return b&&"client"===bV.mode},return_response_type:function(b){return"json"!==b?!0:!!window.JSON},return_status_code:function(J){return"client"===bV.mode||!b.arrayDiff(J,[200,404])},select_file:g.capTrue,select_multiple:g.capTrue,send_binary_string:g.capTrue,send_browser_cookies:function(b){return b&&"browser"===bV.mode},send_custom_headers:function(b){return b&&"client"===bV.mode},send_multipart:g.capTrue,slice_blob:g.capTrue,stream_upload:!0,summon_file_dialog:!1,upload_filesize:g.capTrue,use_http_method:function(J){return"client"===bV.mode||!b.arrayDiff(J,["GET","POST"])}},{return_response_headers:function(b){return b?"client":"browser"},return_status_code:function(J){return b.arrayDiff(J,[200,404])?"client":["client","browser"]},send_browser_cookies:function(b){return b?"browser":"client"},send_custom_headers:function(b){return b?"client":"browser"},use_http_method:function(J){return b.arrayDiff(J,["GET","POST"])?"client":["client","browser"]}}),Qc("2.0.31005.0")&&"Opera"!==J.browser||(this.mode=!1),b.extend(this,{getShim:function(){return e.get(this.uid).content.Moxie},shimExec:function(b,J){var e=[].slice.call(arguments,2);return bV.getShim().exec(this.uid,b,J,e)},init:function(){var b;b=this.getShimContainer(),b.innerHTML='<object id="'+this.uid+'" data="data:application/x-silverlight," type="application/x-silverlight-2" width="100%" height="100%" style="outline:none;">'+'<param name="source" value="'+bc.xap_url+'"/>'+'<param name="background" value="Transparent"/>'+'<param name="windowless" value="true"/>'+'<param name="enablehtmlaccess" value="true"/>'+'<param name="initParams" value="uid='+this.uid+",target="+J.global_event_dispatcher+'"/>'+"</object>",U=setTimeout(function(){bV&&!bV.initialized&&bV.trigger("Error",new Q.RuntimeError(Q.RuntimeError.NOT_INIT_ERR))},"Windows"!==J.OS?1e4:5e3)},destroy:function(b){return function(){b.call(bV),clearTimeout(U),bc=U=b=bV=null}}(this.destroy)},d)}var A="silverlight",d={};return g.addConstructor(A,bc),d}),Q("moxie/runtime/silverlight/file/Blob",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/file/Blob"],function(b,J,e){return b.Blob=J.extend({},e)}),Q("moxie/runtime/silverlight/file/FileInput",["moxie/runtime/silverlight/Runtime","moxie/file/File","moxie/core/utils/Basic"],function(b,J,e){function Q(b){for(var J="",e=0;e<b.length;e++)J+=(""!==J?"|":"")+b[e].title+" | *."+b[e].extensions.replace(/,/g,";*.");return J}var ed={init:function(b){var ed=this,g=this.getRuntime();this.bind("Change",function(){var b=g.shimExec.call(ed,"FileInput","getFiles");ed.files=[],e.each(b,function(b){ed.files.push(new J(g.uid,b))})},999),g.shimExec.call(this,"FileInput","init",Q(b.accept),b.multiple),this.trigger("ready")},setOption:function(b,J){"accept"==b&&(J=Q(J)),this.getRuntime().shimExec.call(this,"FileInput","setOption",b,J)}};return b.FileInput=ed}),Q("moxie/runtime/silverlight/file/FileDrop",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Dom","moxie/core/utils/Events"],function(b,J,e){var Q={init:function(){var b,Q=this,ed=Q.getRuntime();return b=ed.getShimContainer(),e.addEvent(b,"dragover",function(b){b.preventDefault(),b.stopPropagation(),b.dataTransfer.dropEffect="copy"},Q.uid),e.addEvent(b,"dragenter",function(b){b.preventDefault();var e=J.get(ed.uid).dragEnter(b);e&&b.stopPropagation()},Q.uid),e.addEvent(b,"drop",function(b){b.preventDefault();var e=J.get(ed.uid).dragDrop(b);e&&b.stopPropagation()},Q.uid),ed.shimExec.call(this,"FileDrop","init")}};return b.FileDrop=Q}),Q("moxie/runtime/silverlight/file/FileReader",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/file/FileReader"],function(b,J,e){return b.FileReader=J.extend({},e)}),Q("moxie/runtime/silverlight/file/FileReaderSync",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/file/FileReaderSync"],function(b,J,e){return b.FileReaderSync=J.extend({},e)}),Q("moxie/runtime/silverlight/runtime/Transporter",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/runtime/Transporter"],function(b,J,e){return b.Transporter=J.extend({},e)}),Q("moxie/runtime/silverlight/xhr/XMLHttpRequest",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/xhr/XMLHttpRequest","moxie/runtime/silverlight/file/FileReaderSync","moxie/runtime/silverlight/runtime/Transporter"],function(b,J,e){return b.XMLHttpRequest=J.extend({},e)}),Q("moxie/runtime/silverlight/image/Image",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/file/Blob","moxie/runtime/flash/image/Image"],function(b,J,e,Q){return b.Image=J.extend({},Q,{getInfo:function(){var b=this.getRuntime(),Q=["tiff","exif","gps","thumb"],ed={meta:{}},g=b.shimExec.call(this,"Image","getInfo");return g.meta&&(J.each(Q,function(b){var J,e,Q,Qc,bc=g.meta[b];if(bc&&bc.keys)for(ed.meta[b]={},e=0,Q=bc.keys.length;Q>e;e++)J=bc.keys[e],Qc=bc[J],Qc&&(/^(\d|[1-9]\d+)$/.test(Qc)?Qc=parseInt(Qc,10):/^\d*\.\d+$/.test(Qc)&&(Qc=parseFloat(Qc)),ed.meta[b][J]=Qc)}),!ed.meta||!ed.meta.thumb||ed.meta.thumb.data instanceof e||(ed.meta.thumb.data=new e(b.uid,ed.meta.thumb.data))),ed.width=parseInt(g.width,10),ed.height=parseInt(g.height,10),ed.size=parseInt(g.size,10),ed.type=g.type,ed.name=g.name,ed},resize:function(b,J,e){this.getRuntime().shimExec.call(this,"Image","resize",b.x,b.y,b.width,b.height,J,e.preserveHeaders,e.resample)}})}),Q("moxie/runtime/html4/Runtime",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/runtime/Runtime","moxie/core/utils/Env"],function(b,J,e,Q){function g(J){var g=this,A=e.capTest,d=e.capTrue;e.call(this,J,Qc,{access_binary:A(window.FileReader||window.File&&File.getAsDataURL),access_image_binary:!1,display_media:A((Q.can("create_canvas")||Q.can("use_data_uri_over32kb"))&&ed("moxie/image/Image")),do_cors:!1,drag_and_drop:!1,filter_by_extension:A(function(){return!("Chrome"===Q.browser&&Q.verComp(Q.version,28,"<")||"IE"===Q.browser&&Q.verComp(Q.version,10,"<")||"Safari"===Q.browser&&Q.verComp(Q.version,7,"<")||"Firefox"===Q.browser&&Q.verComp(Q.version,37,"<"))}()),resize_image:function(){return bc.Image&&g.can("access_binary")&&Q.can("create_canvas")},report_upload_progress:!1,return_response_headers:!1,return_response_type:function(J){return"json"===J&&window.JSON?!0:!!~b.inArray(J,["text","document",""])},return_status_code:function(J){return!b.arrayDiff(J,[200,404])},select_file:function(){return Q.can("use_fileinput")},select_multiple:!1,send_binary_string:!1,send_custom_headers:!1,send_multipart:!0,slice_blob:!1,stream_upload:function(){return g.can("select_file")},summon_file_dialog:function(){return g.can("select_file")&&("Firefox"===Q.browser&&Q.verComp(Q.version,4,">=")||"Opera"===Q.browser&&Q.verComp(Q.version,12,">=")||"IE"===Q.browser&&Q.verComp(Q.version,10,">=")||!!~b.inArray(Q.browser,["Chrome","Safari"]))},upload_filesize:d,use_http_method:function(J){return!b.arrayDiff(J,["GET","POST"])}}),b.extend(this,{init:function(){this.trigger("Init")},destroy:function(b){return function(){b.call(g),b=g=null}}(this.destroy)}),b.extend(this.getShim(),bc)}var Qc="html4",bc={};return e.addConstructor(Qc,g),bc}),Q("moxie/runtime/html4/file/FileInput",["moxie/runtime/html4/Runtime","moxie/file/File","moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/utils/Events","moxie/core/utils/Mime","moxie/core/utils/Env"],function(b,J,e,Q,ed,g,Qc){function bc(){function b(){var g,d,bV,bI,a,h,c=this,N=c.getRuntime();h=e.guid("uid_"),g=N.getShimContainer(),bc&&(bV=Q.get(bc+"_form"),bV&&e.extend(bV.style,{top:"100%"})),bI=document.createElement("form"),bI.setAttribute("id",h+"_form"),bI.setAttribute("method","post"),bI.setAttribute("enctype","multipart/form-data"),bI.setAttribute("encoding","multipart/form-data"),e.extend(bI.style,{overflow:"hidden",position:"absolute",top:0,left:0,width:"100%",height:"100%"}),a=document.createElement("input"),a.setAttribute("id",h),a.setAttribute("type","file"),a.setAttribute("accept",U.join(",")),e.extend(a.style,{fontSize:"999px",opacity:0}),bI.appendChild(a),g.appendChild(bI),e.extend(a.style,{position:"absolute",top:0,left:0,width:"100%",height:"100%"}),"IE"===Qc.browser&&Qc.verComp(Qc.version,10,"<")&&e.extend(a.style,{filter:"progid:DXImageTransform.Microsoft.Alpha(opacity=0)"}),a.onchange=function(){var e;if(this.value){if(this.files){if(e=this.files[0],0===e.size)return bI.parentNode.removeChild(bI),void 0}else e={name:this.value};e=new J(N.uid,e),this.onchange=function(){},b.call(c),c.files=[e],a.setAttribute("id",e.uid),bI.setAttribute("id",e.uid+"_form"),c.trigger("change"),a=bI=null}},N.can("summon_file_dialog")&&(d=Q.get(A.browse_button),ed.removeEvent(d,"click",c.uid),ed.addEvent(d,"click",function(b){a&&!a.disabled&&a.click(),b.preventDefault()},c.uid)),bc=h,g=bV=d=null}var bc,A,d,U=[];e.extend(this,{init:function(J){var e,Qc=this,bc=Qc.getRuntime();A=J,U=J.accept.mimes||g.extList2mimes(J.accept,bc.can("filter_by_extension")),e=bc.getShimContainer(),function(){var b,g,U;b=Q.get(J.browse_button),d=Q.getStyle(b,"z-index")||"auto",bc.can("summon_file_dialog")&&("static"===Q.getStyle(b,"position")&&(b.style.position="relative"),Qc.bind("Refresh",function(){g=parseInt(d,10)||1,Q.get(A.browse_button).style.zIndex=g,this.getRuntime().getShimContainer().style.zIndex=g-1})),U=bc.can("summon_file_dialog")?b:e,ed.addEvent(U,"mouseover",function(){Qc.trigger("mouseenter")},Qc.uid),ed.addEvent(U,"mouseout",function(){Qc.trigger("mouseleave")},Qc.uid),ed.addEvent(U,"mousedown",function(){Qc.trigger("mousedown")},Qc.uid),ed.addEvent(Q.get(J.container),"mouseup",function(){Qc.trigger("mouseup")},Qc.uid),b=null}(),b.call(this),e=null,Qc.trigger({type:"ready",async:!0})},setOption:function(b,J){var e,ed=this.getRuntime();"accept"==b&&(U=J.mimes||g.extList2mimes(J,ed.can("filter_by_extension"))),e=Q.get(bc),e&&e.setAttribute("accept",U.join(","))},disable:function(b){var J;(J=Q.get(bc))&&(J.disabled=!!b)},destroy:function(){var b=this.getRuntime(),J=b.getShim(),e=b.getShimContainer(),g=A&&Q.get(A.container),Qc=A&&Q.get(A.browse_button);g&&ed.removeAllEvents(g,this.uid),Qc&&(ed.removeAllEvents(Qc,this.uid),Qc.style.zIndex=d),e&&(ed.removeAllEvents(e,this.uid),e.innerHTML=""),J.removeInstance(this.uid),bc=U=A=e=g=Qc=J=null}})}return b.FileInput=bc}),Q("moxie/runtime/html4/file/FileReader",["moxie/runtime/html4/Runtime","moxie/runtime/html5/file/FileReader"],function(b,J){return b.FileReader=J}),Q("moxie/runtime/html4/xhr/XMLHttpRequest",["moxie/runtime/html4/Runtime","moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/utils/Url","moxie/core/Exceptions","moxie/core/utils/Events","moxie/file/Blob","moxie/xhr/FormData"],function(b,J,e,Q,ed,g,Qc,bc){function A(){function b(b){var J,Q,ed,Qc,bc=this,A=!1;if(U){if(J=U.id.replace(/_iframe$/,""),Q=e.get(J+"_form")){for(ed=Q.getElementsByTagName("input"),Qc=ed.length;Qc--;)switch(ed[Qc].getAttribute("type")){case"hidden":ed[Qc].parentNode.removeChild(ed[Qc]);break;case"file":A=!0}ed=[],A||Q.parentNode.removeChild(Q),Q=null}setTimeout(function(){g.removeEvent(U,"load",bc.uid),U.parentNode&&U.parentNode.removeChild(U);var J=bc.getRuntime().getShimContainer();J.children.length||J.parentNode.removeChild(J),J=U=null,b()},1)}}var A,d,U;J.extend(this,{send:function(bV,bI){function a(){var e=de.getShimContainer()||document.body,ed=document.createElement("div");ed.innerHTML='<iframe id="'+h+'_iframe" name="'+h+'_iframe" src="javascript:&quot;&quot;" style="display:none"></iframe>',U=ed.firstChild,e.appendChild(U),g.addEvent(U,"load",function(){var e;try{e=U.contentWindow.document||U.contentDocument||window.frames[U.id].document,/^4(0[0-9]|1[0-7]|2[2346])\s/.test(e.title)?A=e.title.replace(/^(\d+).*$/,"$1"):(A=200,d=J.trim(e.body.innerHTML),ee.trigger({type:"progress",loaded:d.length,total:d.length}),bb&&ee.trigger({type:"uploadprogress",loaded:bb.size||1025,total:bb.size||1025}))}catch(J){if(!Q.hasSameOrigin(bV.url))return b.call(ee,function(){ee.trigger("error")}),void 0;A=404}b.call(ee,function(){ee.trigger("load")})},ee.uid)}var h,c,N,bb,ee=this,de=ee.getRuntime();if(A=d=null,bI instanceof bc&&bI.hasBlob()){if(bb=bI.getBlob(),h=bb.uid,N=e.get(h),c=e.get(h+"_form"),!c)throw new ed.DOMException(ed.DOMException.NOT_FOUND_ERR)}else h=J.guid("uid_"),c=document.createElement("form"),c.setAttribute("id",h+"_form"),c.setAttribute("method",bV.method),c.setAttribute("enctype","multipart/form-data"),c.setAttribute("encoding","multipart/form-data"),de.getShimContainer().appendChild(c);c.setAttribute("target",h+"_iframe"),bI instanceof bc&&bI.each(function(b,e){if(b instanceof Qc)N&&N.setAttribute("name",e);else{var Q=document.createElement("input");J.extend(Q,{type:"hidden",name:e,value:b}),N?c.insertBefore(Q,N):c.appendChild(Q)}}),c.setAttribute("action",bV.url),a(),c.submit(),ee.trigger("loadstart")},getStatus:function(){return A},getResponse:function(b){if("json"===b&&"string"===J.typeOf(d)&&window.JSON)try{return JSON.parse(d.replace(/^\s*<pre[^>]*>/,"").replace(/<\/pre>\s*$/,""))}catch(b){return null}return d},abort:function(){var J=this;U&&U.contentWindow&&(U.contentWindow.stop?U.contentWindow.stop():U.contentWindow.document.execCommand?U.contentWindow.document.execCommand("Stop"):U.src="about:blank"),b.call(this,function(){J.dispatchEvent("abort")})}})}return b.XMLHttpRequest=A}),Q("moxie/runtime/html4/image/Image",["moxie/runtime/html4/Runtime","moxie/runtime/html5/image/Image"],function(b,J){return b.Image=J}),Qc(["moxie/core/utils/Basic","moxie/core/utils/Encode","moxie/core/utils/Env","moxie/core/Exceptions","moxie/core/utils/Dom","moxie/core/EventTarget","moxie/runtime/Runtime","moxie/runtime/RuntimeClient","moxie/file/Blob","moxie/core/I18n","moxie/core/utils/Mime","moxie/file/FileInput","moxie/file/File","moxie/file/FileDrop","moxie/file/FileReader","moxie/core/utils/Url","moxie/runtime/RuntimeTarget","moxie/xhr/FormData","moxie/xhr/XMLHttpRequest","moxie/runtime/Transporter","moxie/image/Image","moxie/core/utils/Events","moxie/runtime/html5/image/ResizerCanvas"])}(this)});!function(b,J){var e=function(){var b={};return J.apply(b,arguments),b.plupload};"function"==typeof define&&define.amd?define("plupload",["./moxie"],e):"object"==typeof module&&module.exports?module.exports=e(require("./moxie")):b.plupload=e(b.moxie)}(this||window,function(b){!function(b,J,e){function Q(b){function J(b,J,e){var ed={chunks:"slice_blob",jpgresize:"send_binary_string",pngresize:"send_binary_string",progress:"report_upload_progress",multi_selection:"select_multiple",dragdrop:"drag_and_drop",drop_element:"drag_and_drop",headers:"send_custom_headers",urlstream_upload:"send_binary_string",canSendBinary:"send_binary",triggerDialog:"summon_file_dialog"};ed[b]?Q[ed[b]]=J:e||(Q[b]=J)}var e=b.required_features,Q={};return"string"==typeof e?A.each(e.split(/\s*,\s*/),function(b){J(b,!0)}):"object"==typeof e?A.each(e,function(b,e){J(e,b)}):e===!0&&(b.chunk_size>0&&(Q.slice_blob=!0),A.isEmptyObj(b.resize)&&b.multipart||(Q.send_binary_string=!0),A.each(b,function(b,e){J(e,!!b,!0)})),Q}var ed=window.setTimeout,g={},Qc=J.core.utils,bc=J.runtime.Runtime,A={VERSION:"2.2.1",STOPPED:1,STARTED:2,QUEUED:1,UPLOADING:2,FAILED:4,DONE:5,GENERIC_ERROR:-100,HTTP_ERROR:-200,IO_ERROR:-300,SECURITY_ERROR:-400,INIT_ERROR:-500,FILE_SIZE_ERROR:-600,FILE_EXTENSION_ERROR:-601,FILE_DUPLICATE_ERROR:-602,IMAGE_FORMAT_ERROR:-700,MEMORY_ERROR:-701,IMAGE_DIMENSIONS_ERROR:-702,mimeTypes:Qc.Mime.mimes,ua:Qc.Env,typeOf:Qc.Basic.typeOf,extend:Qc.Basic.extend,guid:Qc.Basic.guid,getAll:function(b){var J,e=[];"array"!==A.typeOf(b)&&(b=[b]);for(var Q=b.length;Q--;)J=A.get(b[Q]),J&&e.push(J);return e.length?e:null},get:Qc.Dom.get,each:Qc.Basic.each,getPos:Qc.Dom.getPos,getSize:Qc.Dom.getSize,xmlEncode:function(b){var J={"<":"lt",">":"gt","&":"amp",'"':"quot","'":"#39"},e=/[<>&\"\']/g;return b?(""+b).replace(e,function(b){return J[b]?"&"+J[b]+";":b}):b},toArray:Qc.Basic.toArray,inArray:Qc.Basic.inArray,inSeries:Qc.Basic.inSeries,addI18n:J.core.I18n.addI18n,translate:J.core.I18n.translate,sprintf:Qc.Basic.sprintf,isEmptyObj:Qc.Basic.isEmptyObj,hasClass:Qc.Dom.hasClass,addClass:Qc.Dom.addClass,removeClass:Qc.Dom.removeClass,getStyle:Qc.Dom.getStyle,addEvent:Qc.Events.addEvent,removeEvent:Qc.Events.removeEvent,removeAllEvents:Qc.Events.removeAllEvents,cleanName:function(b){var J,e;for(e=[/[\300-\306]/g,"A",/[\340-\346]/g,"a",/\307/g,"C",/\347/g,"c",/[\310-\313]/g,"E",/[\350-\353]/g,"e",/[\314-\317]/g,"I",/[\354-\357]/g,"i",/\321/g,"N",/\361/g,"n",/[\322-\330]/g,"O",/[\362-\370]/g,"o",/[\331-\334]/g,"U",/[\371-\374]/g,"u"],J=0;J<e.length;J+=2)b=b.replace(e[J],e[J+1]);return b=b.replace(/\s+/g,"_"),b=b.replace(/[^a-z0-9_\-\.]+/gi,"")},buildUrl:function(b,J){var e="";return A.each(J,function(b,J){e+=(e?"&":"")+encodeURIComponent(J)+"="+encodeURIComponent(b)}),e&&(b+=(b.indexOf("?")>0?"&":"?")+e),b},formatSize:function(b){function J(b,J){return Math.round(b*Math.pow(10,J))/Math.pow(10,J)}if(b===e||/\D/.test(b))return A.translate("N/A");var Q=Math.pow(1024,4);return b>Q?J(b/Q,1)+" "+A.translate("tb"):b>(Q/=1024)?J(b/Q,1)+" "+A.translate("gb"):b>(Q/=1024)?J(b/Q,1)+" "+A.translate("mb"):b>1024?Math.round(b/1024)+" "+A.translate("kb"):b+" "+A.translate("b")},parseSize:Qc.Basic.parseSizeStr,predictRuntime:function(b,J){var e,Q;return e=new A.Uploader(b),Q=bc.thatCan(e.getOption().required_features,J||b.runtimes),e.destroy(),Q},addFileFilter:function(b,J){g[b]=J}};A.addFileFilter("mime_types",function(b,J,e){b.length&&!b.regexp.test(J.name)?(this.trigger("Error",{code:A.FILE_EXTENSION_ERROR,message:A.translate("File extension error."),file:J}),e(!1)):e(!0)}),A.addFileFilter("max_file_size",function(b,J,e){var Q;b=A.parseSize(b),J.size!==Q&&b&&J.size>b?(this.trigger("Error",{code:A.FILE_SIZE_ERROR,message:A.translate("File size error."),file:J}),e(!1)):e(!0)}),A.addFileFilter("prevent_duplicates",function(b,J,e){if(b)for(var Q=this.files.length;Q--;)if(J.name===this.files[Q].name&&J.size===this.files[Q].size)return this.trigger("Error",{code:A.FILE_DUPLICATE_ERROR,message:A.translate("Duplicate file error."),file:J}),e(!1),void 0;e(!0)}),A.Uploader=function(b){function Qc(){var b,J,e=0;if(this.state==A.STARTED){for(J=0;J<ch.length;J++)b||ch[J].status!=A.QUEUED?e++:(b=ch[J],this.trigger("BeforeUpload",b)&&(b.status=A.UPLOADING,this.trigger("UploadFile",b)));e==ch.length&&(this.state!==A.STOPPED&&(this.state=A.STOPPED,this.trigger("StateChanged")),this.trigger("UploadComplete",ch))}}function d(b){b.percent=b.size>0?Math.ceil(100*(b.loaded/b.size)):100,U()}function U(){var b,J;for(E.reset(),b=0;b<ch.length;b++)J=ch[b],J.size!==e?(E.size+=J.origSize,E.loaded+=J.loaded*J.origSize/J.size):E.size=e,J.status==A.DONE?E.uploaded++:J.status==A.FAILED?E.failed++:E.queued++;E.size===e?E.percent=ch.length>0?Math.ceil(100*(E.uploaded/ch.length)):0:(E.bytesPerSec=Math.ceil(E.loaded/((+new Date-eb||1)/1e3)),E.percent=E.size>0?Math.ceil(100*(E.loaded/E.size)):0)}function bV(){var b=gU[0]||aL[0];return b?b.getRuntime().uid:!1}function bI(b,J){if(b.ruid){var e=bc.getInfo(b.ruid);if(e)return e.can(J)}return!1}function a(){this.bind("FilesAdded FilesRemoved",function(b){b.trigger("QueueChanged"),b.refresh()}),this.bind("CancelUpload",aH),this.bind("BeforeUpload",bb),this.bind("UploadFile",ee),this.bind("UploadProgress",de),this.bind("StateChanged",gS),this.bind("QueueChanged",U),this.bind("Error",gc),this.bind("FileUploaded",gE),this.bind("Destroy",gf)}function h(b,e){var Q=this,ed=0,g=[],Qc={runtime_order:b.runtimes,required_caps:b.required_features,preferred_caps:bB,swf_url:b.flash_swf_url,xap_url:b.silverlight_xap_url};A.each(b.runtimes.split(/\s*,\s*/),function(J){b[J]&&(Qc[J]=b[J])}),b.browse_button&&A.each(b.browse_button,function(e){g.push(function(g){var d=new J.file.FileInput(A.extend({},Qc,{accept:b.filters.mime_types,name:b.file_data_name,multiple:b.multi_selection,container:b.container,browse_button:e}));d.onready=function(){var b=bc.getInfo(this.ruid);A.extend(Q.features,{chunks:b.can("slice_blob"),multipart:b.can("send_multipart"),multi_selection:b.can("select_multiple")}),ed++,gU.push(this),g()},d.onchange=function(){Q.addFile(this.files)},d.bind("mouseenter mouseleave mousedown mouseup",function(J){ab||(b.browse_button_hover&&("mouseenter"===J.type?A.addClass(e,b.browse_button_hover):"mouseleave"===J.type&&A.removeClass(e,b.browse_button_hover)),b.browse_button_active&&("mousedown"===J.type?A.addClass(e,b.browse_button_active):"mouseup"===J.type&&A.removeClass(e,b.browse_button_active)))}),d.bind("mousedown",function(){Q.trigger("Browse")}),d.bind("error runtimeerror",function(){d=null,g()}),d.init()})}),b.drop_element&&A.each(b.drop_element,function(b){g.push(function(e){var g=new J.file.FileDrop(A.extend({},Qc,{drop_zone:b}));g.onready=function(){var b=bc.getInfo(this.ruid);A.extend(Q.features,{chunks:b.can("slice_blob"),multipart:b.can("send_multipart"),dragdrop:b.can("drag_and_drop")}),ed++,aL.push(this),e()},g.ondrop=function(){Q.addFile(this.files)},g.bind("error runtimeerror",function(){g=null,e()}),g.init()})}),A.inSeries(g,function(){"function"==typeof e&&e(ed)})}function c(b,Q,ed){var g=new J.image.Image;try{g.onload=function(){return Q.width>this.width&&Q.height>this.height&&Q.quality===e&&Q.preserve_headers&&!Q.crop?(this.destroy(),ed(b)):(g.downsize(Q.width,Q.height,Q.crop,Q.preserve_headers),void 0)},g.onresize=function(){ed(this.getAsBlob(b.type,Q.quality)),this.destroy()},g.onerror=function(){ed(b)},g.load(b)}catch(J){ed(b)}}function N(b,e,ed){function g(b,e,Q){var ed=f[b];switch(b){case"max_file_size":"max_file_size"===b&&(f.max_file_size=f.filters.max_file_size=e);break;case"chunk_size":(e=A.parseSize(e))&&(f[b]=e,f.send_file_name=!0);break;case"multipart":f[b]=e,e||(f.send_file_name=!0);break;case"unique_names":f[b]=e,e&&(f.send_file_name=!0);break;case"filters":"array"===A.typeOf(e)&&(e={mime_types:e}),Q?A.extend(f.filters,e):f.filters=e,e.mime_types&&("string"===A.typeOf(e.mime_types)&&(e.mime_types=J.core.utils.Mime.mimes2extList(e.mime_types)),e.mime_types.regexp=function(b){var J=[];return A.each(b,function(b){A.each(b.extensions.split(/,/),function(b){/^\s*\*\s*$/.test(b)?J.push("\\.*"):J.push("\\."+b.replace(new RegExp("["+"/^$.*+?|()[]{}\\".replace(/./g,"\\$&")+"]","g"),"\\$&"))})}),new RegExp("("+J.join("|")+")$","i")}(e.mime_types),f.filters.mime_types=e.mime_types);break;case"resize":f.resize=e?A.extend({preserve_headers:!0,crop:!1},e):!1;break;case"prevent_duplicates":f.prevent_duplicates=f.filters.prevent_duplicates=!!e;break;case"container":case"browse_button":case"drop_element":e="container"===b?A.get(e):A.getAll(e);case"runtimes":case"multi_selection":case"flash_swf_url":case"silverlight_xap_url":f[b]=e,Q||(d=!0);break;default:f[b]=e}Q||Qc.trigger("OptionChanged",b,e,ed)}var Qc=this,d=!1;"object"==typeof b?A.each(b,function(b,J){g(J,b,ed)}):g(b,e,ed),ed?(f.required_features=Q(A.extend({},f)),bB=Q(A.extend({},f,{required_features:!0}))):d&&(Qc.trigger("Destroy"),h.call(Qc,f,function(b){b?(Qc.runtime=bc.getInfo(bV()).type,Qc.trigger("Init",{runtime:Qc.runtime}),Qc.trigger("PostInit")):Qc.trigger("Error",{code:A.INIT_ERROR,message:A.translate("Init error.")})}))}function bb(b,J){if(b.settings.unique_names){var e=J.name.match(/\.([^.]+)$/),Q="part";e&&(Q=e[1]),J.target_name=J.id+"."+Q}}function ee(b,e){function Q(){U-- >0?ed(g,1e3):(e.loaded=a,b.trigger("Error",{code:A.HTTP_ERROR,message:A.translate("HTTP Error."),file:e,response:hd.responseText,status:hd.status,responseHeaders:hd.getAllResponseHeaders()}))}function g(){var bI,h,c,N={};e.status===A.UPLOADING&&b.state!==A.STOPPED&&(b.settings.send_file_name&&(N.name=e.target_name||e.name),d&&bV.chunks&&Qc.size>d?(c=Math.min(d,Qc.size-a),bI=Qc.slice(a,a+c)):(c=Qc.size,bI=Qc),d&&bV.chunks&&(b.settings.send_chunk_number?(N.chunk=Math.ceil(a/d),N.chunks=Math.ceil(Qc.size/d)):(N.offset=a,N.total=Qc.size)),hd=new J.xhr.XMLHttpRequest,hd.upload&&(hd.upload.onprogress=function(J){e.loaded=Math.min(e.size,a+J.loaded),b.trigger("UploadProgress",e)}),hd.onload=function(){return hd.status>=400?(Q(),void 0):(U=b.settings.max_retries,c<Qc.size?(bI.destroy(),a+=c,e.loaded=Math.min(a,Qc.size),b.trigger("ChunkUploaded",e,{offset:e.loaded,total:Qc.size,response:hd.responseText,status:hd.status,responseHeaders:hd.getAllResponseHeaders()}),"Android Browser"===A.ua.browser&&b.trigger("UploadProgress",e)):e.loaded=e.size,bI=h=null,!a||a>=Qc.size?(e.size!=e.origSize&&(Qc.destroy(),Qc=null),b.trigger("UploadProgress",e),e.status=A.DONE,b.trigger("FileUploaded",e,{response:hd.responseText,status:hd.status,responseHeaders:hd.getAllResponseHeaders()})):ed(g,1),void 0)},hd.onerror=function(){Q()},hd.onloadend=function(){this.destroy(),hd=null},b.settings.multipart&&bV.multipart?(hd.open("post",bc,!0),A.each(b.settings.headers,function(b,J){hd.setRequestHeader(J,b)}),h=new J.xhr.FormData,A.each(A.extend(N,b.settings.multipart_params),function(b,J){h.append(J,b)}),h.append(b.settings.file_data_name,bI),hd.send(h,{runtime_order:b.settings.runtimes,required_caps:b.settings.required_features,preferred_caps:bB,swf_url:b.settings.flash_swf_url,xap_url:b.settings.silverlight_xap_url})):(bc=A.buildUrl(b.settings.url,A.extend(N,b.settings.multipart_params)),hd.open("post",bc,!0),A.each(b.settings.headers,function(b,J){hd.setRequestHeader(J,b)}),hd.hasRequestHeader("Content-Type")||hd.setRequestHeader("Content-Type","application/octet-stream"),hd.send(bI,{runtime_order:b.settings.runtimes,required_caps:b.settings.required_features,preferred_caps:bB,swf_url:b.settings.flash_swf_url,xap_url:b.settings.silverlight_xap_url})))}var Qc,bc=b.settings.url,d=b.settings.chunk_size,U=b.settings.max_retries,bV=b.features,a=0;e.loaded&&(a=e.loaded=d?d*Math.floor(e.loaded/d):0),Qc=e.getSource(),!A.isEmptyObj(b.settings.resize)&&bI(Qc,"send_binary_string")&&-1!==A.inArray(Qc.type,["image/jpeg","image/png"])?c.call(this,Qc,b.settings.resize,function(b){Qc=b,e.size=b.size,g()}):g()}function de(b,J){d(J)}function gS(b){if(b.state==A.STARTED)eb=+new Date;else if(b.state==A.STOPPED)for(var J=b.files.length-1;J>=0;J--)b.files[J].status==A.UPLOADING&&(b.files[J].status=A.QUEUED,U())}function aH(){hd&&hd.abort()}function gE(b){U(),ed(function(){Qc.call(b)},1)}function gc(b,J){J.code===A.INIT_ERROR?b.destroy():J.code===A.HTTP_ERROR&&(J.file.status=A.FAILED,d(J.file),b.state==A.STARTED&&(b.trigger("CancelUpload"),ed(function(){Qc.call(b)},1)))}function gf(b){b.stop(),A.each(ch,function(b){b.destroy()}),ch=[],gU.length&&(A.each(gU,function(b){b.destroy()}),gU=[]),aL.length&&(A.each(aL,function(b){b.destroy()}),aL=[]),bB={},ab=!1,eb=hd=null,E.reset()}var f,eb,E,hd,cS=A.guid(),ch=[],bB={},gU=[],aL=[],ab=!1;f={runtimes:bc.order,max_retries:0,chunk_size:0,multipart:!0,multi_selection:!0,file_data_name:"file",flash_swf_url:"js/Moxie.swf",silverlight_xap_url:"js/Moxie.xap",filters:{mime_types:[],prevent_duplicates:!1,max_file_size:0},resize:!1,send_file_name:!0,send_chunk_number:!0},N.call(this,b,null,!0),E=new A.QueueProgress,A.extend(this,{id:cS,uid:cS,state:A.STOPPED,features:{},runtime:null,files:ch,settings:f,total:E,init:function(){var b,J,e=this;return b=e.getOption("preinit"),"function"==typeof b?b(e):A.each(b,function(b,J){e.bind(J,b)}),a.call(e),A.each(["container","browse_button","drop_element"],function(b){return null===e.getOption(b)?(J={code:A.INIT_ERROR,message:A.sprintf(A.translate("%s specified, but cannot be found."),b)},!1):void 0}),J?e.trigger("Error",J):f.browse_button||f.drop_element?(h.call(e,f,function(b){var J=e.getOption("init");"function"==typeof J?J(e):A.each(J,function(b,J){e.bind(J,b)}),b?(e.runtime=bc.getInfo(bV()).type,e.trigger("Init",{runtime:e.runtime}),e.trigger("PostInit")):e.trigger("Error",{code:A.INIT_ERROR,message:A.translate("Init error.")})}),void 0):e.trigger("Error",{code:A.INIT_ERROR,message:A.translate("You must specify either browse_button or drop_element.")})},setOption:function(b,J){N.call(this,b,J,!this.runtime)},getOption:function(b){return b?f[b]:f},refresh:function(){gU.length&&A.each(gU,function(b){b.trigger("Refresh")}),this.trigger("Refresh")},start:function(){this.state!=A.STARTED&&(this.state=A.STARTED,this.trigger("StateChanged"),Qc.call(this))},stop:function(){this.state!=A.STOPPED&&(this.state=A.STOPPED,this.trigger("StateChanged"),this.trigger("CancelUpload"))},disableBrowse:function(){ab=arguments[0]!==e?arguments[0]:!0,gU.length&&A.each(gU,function(b){b.disable(ab)}),this.trigger("DisableBrowse",ab)},getFile:function(b){var J;for(J=ch.length-1;J>=0;J--)if(ch[J].id===b)return ch[J]},addFile:function(b,e){function Q(b,J){var e=[];A.each(d.settings.filters,function(J,Q){g[Q]&&e.push(function(e){g[Q].call(d,J,b,function(b){e(!b)})})}),A.inSeries(e,J)}function Qc(b){var g=A.typeOf(b);if(b instanceof J.file.File){if(!b.ruid&&!b.isDetached()){if(!bc)return!1;b.ruid=bc,b.connectRuntime(bc)}Qc(new A.File(b))}else b instanceof J.file.Blob?(Qc(b.getSource()),b.destroy()):b instanceof A.File?(e&&(b.name=e),U.push(function(J){Q(b,function(e){e||(ch.push(b),bI.push(b),d.trigger("FileFiltered",b)),ed(J,1)})})):-1!==A.inArray(g,["file","blob"])?Qc(new J.file.File(null,b)):"node"===g&&"filelist"===A.typeOf(b.files)?A.each(b.files,Qc):"array"===g&&(e=null,A.each(b,Qc))}var bc,d=this,U=[],bI=[];bc=bV(),Qc(b),U.length&&A.inSeries(U,function(){bI.length&&d.trigger("FilesAdded",bI)})},removeFile:function(b){for(var J="string"==typeof b?b:b.id,e=ch.length-1;e>=0;e--)if(ch[e].id===J)return this.splice(e,1)[0]},splice:function(b,J){var Q=ch.splice(b===e?0:b,J===e?ch.length:J),ed=!1;return this.state==A.STARTED&&(A.each(Q,function(b){return b.status===A.UPLOADING?(ed=!0,!1):void 0}),ed&&this.stop()),this.trigger("FilesRemoved",Q),A.each(Q,function(b){b.destroy()}),ed&&this.start(),Q},dispatchEvent:function(b){var J,e;if(b=b.toLowerCase(),J=this.hasEventListener(b)){J.sort(function(b,J){return J.priority-b.priority}),e=[].slice.call(arguments),e.shift(),e.unshift(this);for(var Q=0;Q<J.length;Q++)if(J[Q].fn.apply(J[Q].scope,e)===!1)return!1}return!0},bind:function(b,J,e,Q){A.Uploader.prototype.bind.call(this,b,J,Q,e)},destroy:function(){this.trigger("Destroy"),f=E=null,this.unbindAll()}})},A.Uploader.prototype=J.core.EventTarget.instance,A.File=function(){function b(b){A.extend(this,{id:A.guid(),name:b.name||b.fileName,type:b.type||"",size:b.size||b.fileSize,origSize:b.size||b.fileSize,loaded:0,percent:0,status:A.QUEUED,lastModifiedDate:b.lastModifiedDate||(new Date).toLocaleString(),getNative:function(){var b=this.getSource().getSource();return-1!==A.inArray(A.typeOf(b),["blob","file"])?b:null},getSource:function(){return J[this.id]?J[this.id]:null},destroy:function(){var b=this.getSource();b&&(b.destroy(),delete J[this.id])}}),J[this.id]=b}var J={};return b}(),A.QueueProgress=function(){var b=this;b.size=0,b.loaded=0,b.uploaded=0,b.failed=0,b.queued=0,b.percent=0,b.bytesPerSec=0,b.reset=function(){b.size=b.loaded=b.uploaded=b.failed=b.queued=b.percent=b.bytesPerSec=0}},b.plupload=A}(this,b)});(function(b,J,e,Q,ed){"use strict";if(!b.zui.strCode){b.zui.strCode=function(b){var J=0;if(b&&b.length){for(var e=0;e<b.length;++e){J+=e*b.charCodeAt(e)}}return J}}var g="zui.uploader",Qc='<div class="file"><div class="file-progress-bar"></div><div class="file-wrapper"><div class="file-icon"><i class="icon icon-file-o"></i></div><div class="content"><div class="file-name"></div><div class="file-size small text-muted">0KB</div></div><div class="actions"><div class="file-status" data-toggle="tooltip"><i class="icon"></i> <span class="text"></span></div><a data-toggle="tooltip" class="btn btn-link btn-download-file" target="_blank"><i class="icon icon-download-alt"></i></a><button type="button" data-toggle="tooltip" class="btn btn-link btn-reset-file" title="Repeat"><i class="icon icon-repeat"></i></button><button type="button" data-toggle="tooltip" class="btn btn-link btn-rename-file" title="Rename"><i class="icon icon-pencil"></i></button><button type="button" data-toggle="tooltip" title="Remove" class="btn btn-link btn-delete-file"><i class="icon icon-trash text-danger"></i></button></div></div></div>',bc={rename:true,renameByClick:true,dropPlaceholder:true,previewImageIcon:true,sendFileName:true,sendFileId:true,responseHandler:true,uploadedMessage:true,drop_element:"self",browse_button:"hidden",filters:{prevent_duplicates:true},chunk_size:"1mb",max_retries:3,flash_swf_url:"lib/uploader/Moxie.swf",silverlight_xap_url:"lib/uploader/Moxie.xap"};var A={QUEUED:e.QUEUED,UPLOADING:e.UPLOADING,FAILED:e.FAILED,DONE:e.DONE,STOPPED:e.STOPPED,STARTED:e.STARTED};A[e.QUEUED]="queue";A[e.UPLOADING]="uploading";A[e.FAILED]="failed";A[e.DONE]="done";var d={GENERIC_ERROR:e.GENERIC_ERROR,HTTP_ERROR:e.HTTP_ERROR,IO_ERROR:e.IO_ERROR,SECURITY_ERROR:e.SECURITY_ERROR,INIT_ERROR:e.INIT_ERROR,FILE_SIZE_ERROR:e.FILE_SIZE_ERROR,FILE_EXTENSION_ERROR:e.FILE_EXTENSION_ERROR,FILE_DUPLICATE_ERROR:e.FILE_DUPLICATE_ERROR,IMAGE_FORMAT_ERROR:e.IMAGE_FORMAT_ERROR,IMAGE_MEMORY_ERROR:e.IMAGE_MEMORY_ERROR,IMAGE_DIMENSIONS_ERROR:e.IMAGE_DIMENSIONS_ERROR};var U=function(Q,bc){var A=this;A.name=g;A.$=b(Q).addClass("uploader");bc=A.getOptions(bc);var d=b.isPlainObject(bc.lang)?b.extend(true,{},U.LANG[d.lang||b.zui.clientLang()],bc.lang):U.LANG[bc.lang];A.lang=d;var bV=A.$;var bI=bc.fileList;var a;if(!bI||bI=="large"||bI=="grid"){a=bV.find(".file-list,.uploader-files")}else if(bI.indexOf(">")===0)a=bV.find(bI.substr(1));else a=b(bI);if(!a||!a.length)a=b('<div class="uploader-files file-list"></div>');if(!a.parent().length)bV.append(a);if(bI=="large")a.addClass("file-list-lg");else if(bI=="grid")a.addClass("file-list-grid");a.children(".file").addClass("file-static");A.$list=a;if(bc.browseByClickList||a.hasClass("uploader-btn-browse")){a.addClass("uploader-btn-browse").on("click",".file-wrapper > .actions,.file-renaming .file-name",function(b){b.stopPropagation()})}var h=bc.fileTemplate;if(!h){var c=a.find(".template");if(c.length){h=c.first().clone().removeClass("template");c.remove()}if(!h)h=Qc}if(typeof h==="string"){h=b(h);if(h.parent())h=h.clone().removeClass("template")}A.template=h;var N=bc.browse_button;var bb=null;if(N){if(N.indexOf(">")===0)bb=bV.find(N.substr(1));else if(N!=="hidden")bb=b(N)}if(!bb||!bb.length){bb=b('<div class="uploader-btn-browse uploader-btn-hidden"></div>').appendTo(bV)}A.$button=bb.first();var ee=bc.drop_element;var de=(ee=="fileList"?A.$list:ee=="self"?A.$:b(ee)).first().addClass("file-drag-area");var gS=bc.dropPlaceholder;if(gS===true)gS=d.dropPlaceholder;if(gS)de.attr("data-drop-placeholder",gS);A.$dropElement=de;A.$message=bV.find(".uploader-message").on("click",".close",function(){A.hideMessage()});A.$status=bV.find(".uploader-status");bV.toggleClass("uploader-rename",!!bc.rename);A.initPlupload();bV.on("click."+g,".uploader-btn-start",function(b){A.start()}).on("click."+g,".uploader-btn-browse",function(J){if(b(this).is(A.$button))return;A.$button.trigger("click")}).on("click."+g,".uploader-btn-stop",function(b){A.stop()});b("body").on("dragleave."+g+" drop."+g,function(b){bV.removeClass("file-dragable")}).on("dragover."+g+" dragenter."+g,function(b){bV.addClass("file-dragable")});de.on("dragleave."+g+" drop."+g,function(b){bV.removeClass("file-drag-enter")}).on("dragover."+g+" dragenter."+g,function(b){bV.addClass("file-drag-enter")});a.on("click."+g,".btn-delete-file",function(){var Q=b(this).closest(".file");var ed=Q.data("file");var g=bc.deleteActionOnDone;var Qc=ed.status===e.DONE&&b.isFunction(g);if(ed.status===e.QUEUED||ed.status===e.FAILED||Qc){var U=function(){A.removeFile(ed)};var bV=function(){if(Qc){var b=g.call(A,ed,U);if(b===true){U()}}else{U()}};var bI=bc.deleteConfirm;if(bI){var a=b.isFunction(bI)?bI(ed):bI===true?d.deleteConfirm:bI;a=a.format(ed);if(J.bootbox){J.bootbox.confirm(a,function(b){if(b)bV()})}else{if(J.confirm(a))bV()}}else{bV()}}}).on("click."+g,".btn-reset-file",function(){var J=b(this).closest(".file");var Q=A.plupload.getFile(J.data("id"))||J.data("file");if(Q.status===e.FAILED){Q.status=e.QUEUED;A.showFile(Q);if(bc.autoUpload)A.start()}});if(bc.rename){a.toggleClass("file-rename-by-click",!!bc.renameByClick).toggleClass("file-show-rename-action-on-done",!!bc.renameActionOnDone);a.on("click."+g,".btn-rename-file"+(bc.renameByClick?",.file-name":""),function(){var J=b(this).closest(".file");if(J.hasClass("file-renaming"))return;var Q=A.plupload.getFile(J.data("id"))||J.data("file");var Qc=bc.renameActionOnDone;var d=Q.status===e.DONE&&b.isFunction(Qc);if(d||Q.status===e.QUEUED){var U=J.find(".file-name").first();J.addClass("file-renaming");A.showFile(Q);if(!bc.renameExtension&&Q.ext){U.text(Q.name.substr(0,Q.name.length-Q.ext.length-1))}U.attr("contenteditable","true").one("blur",function(){var e=b.trim(U.text());var bV=function(){if(e!==ed&&e!==null&&e!==""){var b=Q.ext;if(b.length&&!bc.renameExtension&&e.lastIndexOf("."+b)!==e.length-b.length-1){e+="."+b}Q.name=e}A.showFile(Q)};if(d){var bI=Qc.call(A,Q,e,bV);if(bI===true){doRemoveFile()}else if(bI===false){A.showFile(Q)}}else{bV()}J.removeClass("file-renaming");U.off("keydown."+g).attr("contenteditable",null)}).on("keydown."+g,function(b){if(b.keyCode===13){U.blur();b.preventDefault()}}).focus()}})}a.toggleClass("file-show-delete-action-on-done",!!bc.deleteActionOnDone);if(bc.staticFiles){b.each(bc.staticFiles,function(J,Q){Q=b.extend({status:e.DONE},Q);Q.static=true;if(!Q.id)Q.id=b.zui.uuid();A.showFile(Q)})}A.callEvent("onInit")};U.DEFAULTS=bc;U.prototype.showMessage=function(b,J,e){var Q=this;var g=Q.$message;if(!b)Q.hideMessage();else clearTimeout(Q.lastDismissMessage);J=J||"danger";if(e===ed)e=J==="danger"?8:5;if(e<20)e*=1e3;var Qc=g.find(".content");if(Qc.length)Qc.empty().append(b);else g.empty().append(b);g.attr("data-type",J).slideDown("fast");if(e){Q.lastDismissMessage=setTimeout(function(){Q.hideMessage()},e)}};U.prototype.hideMessage=function(){clearTimeout(this.lastDismissMessage);this.$message.slideUp("fast")};U.prototype.start=function(){return this.plupload.start()};U.prototype.stop=function(){return this.plupload.stop()};U.prototype.getState=function(){return this.plupload.state};U.prototype.isStarted=function(){return this.getState()===e.STARTED};U.prototype.isStopped=function(){return this.getState()===e.STOPPED};U.prototype.getFiles=function(){return this.plupload.files};U.prototype.getTotal=function(){return this.plupload.total};U.prototype.disableBrowse=function(b){this.$.find(".uploader-btn-browse").attr("disable",b?"disable":null).toggle("disable",!!b);return this.plupload.disableBrowse()};U.prototype.getFile=function(b){return this.plupload.getFile(b)};U.prototype.destroy=function(){var J=this;var e="."+g;J.$.off(e).data(g,null);J.$list.off(e);J.$dropElement.off(e);b("body").off(e);J.plupload.destroy()};U.prototype.previewImageSrc=function(J,e){if(!J||!J.getSource||!/image\//.test(J.type))return;var ed=b.extend({width:200,height:200},this.options.previewImageSize);if(J.type=="image/gif"){var g=new Q.file.FileReader;g.onload=function(){e(g.result);g.destroy();g=null};g.readAsDataURL(J.getSource())}else{var Qc=new Q.image.Image;Qc.onload=function(){Qc.downsize(ed.width,ed.height);var b=Qc.type=="image/jpeg"?Qc.getAsDataURL("image/jpeg",80):Qc.getAsDataURL();e(b);Qc.destroy();Qc=null};Qc.load(J.getSource())}};U.prototype.createFileIcon=function(b){var J=b.type;var e=b.ext;var Q="file-o";var ed=J?J.split("/"):null;var g=ed&&ed.length?ed[0]:"",Qc=(ed&&ed.length)>1?ed[1]:"";if(g=="image")Q="file-image";else if(e=="doc"||e=="docx"||e=="pages")Q="file-word";else if(e=="ppt"||e=="pptx"||e=="key")Q="file-powerpoint";else if(e=="xls"||e=="xlsx"||e=="numbers")Q="file-excel";else if(e=="html"||e=="htm")Q="globe";else if(e=="js"||e=="php"||e=="cs"||e=="jsx"||e=="css"||e=="less"||e=="json"||e=="java"||e=="lua"||e=="py"||e=="c"||e=="cpp"||e=="swift"||e=="h"||e=="sh"||e=="rb"||e=="yml"||e=="ini"||e=="sql"||e=="xml")Q="file-code";else if(e=="apk")Q="android";else if(e=="exe")Q="windows";else if(e=="pkg"||e=="msi"||e=="dmg")Q="cube";else if(e=="epub")Q="book";else if(e=="sketch")Q="diamond";else if(Qc=="zip"||Qc=="x-rar"||Qc=="x-7z-compressed")Q="file-archive";else if(Qc=="pdf")Q="file-pdf";else if(g=="video")Q="file-movie";else if(g=="audio")Q="file-audio";else if(g=="text")Q="file-text-o";return'<i class="icon icon-'+Q+" file-icon-"+e+'" data-type="'+J+'"'+(e?' data-ext="'+e+'"':"")+"></i>"};U.prototype.getFileItem=function(J){var e=this;if(typeof J=="string"){J=e.plupload.getFile(J)}if(!J)return null;var Q=J.name;if(Q&&J.ext===ed){var g=Q.lastIndexOf(".");if(g>-1)g=Q.substr(g+1);else g="";J.ext=g;if(J.type&&/image\//.test(J.type)){J.isImage=J.ext}}var Qc=b("#file-"+J.id);if(!Qc.length){if(b.isFunction(e.template)){Qc=b(e.template(J,e))}else{Qc=b(e.template).clone();Qc.find(".btn-rename-file").attr("title",e.lang.rename);Qc.find(".btn-delete-file").attr("title",e.lang.remove);Qc.find(".btn-reset-file").attr("title",e.lang.repeat);Qc.find(".btn-download-file").attr("title",e.lang.download).attr("download",J.name)}Qc.data("id",J.id).toggleClass("file-static",!!J.static).attr("id","file-"+J.id).appendTo(e.$list);if(b.fn.tooltip)Qc.find('[data-toggle="tooltip"]').tooltip()}return Qc};U.prototype.showFile=function(J,Q){var ed=this;if(b.isArray(J)){b.each(J,function(b,J){ed.showFile(J,Q)});return}if(typeof J=="string"){J=ed.plupload.getFile(J)}if(!J)return;var g=ed.getFileItem(J);if(!g||!g.length){return}var Qc=ed.options;var bc=A[J.status];if(Qc.fileFormater){Qc.fileFormater.call(ed,g,J,bc)}else{var d=bc=="done"&&J.url?J.url:null;g.find(".file-name").text(J.name);g.find(".file-size").text((bc=="uploading"?e.formatSize(Math.floor(J.size*J.percent/100)).toUpperCase()+"/":"")+e.formatSize(J.size).toUpperCase());g.find(".file-icon").html(Qc.fileIconCreator?Qc.fileIconCreator(J.type,J,ed):ed.createFileIcon(J)).css("color","hsl("+b.zui.strCode(J.type||J.ext)+", 70%, 40%)");g.find(".file-progress-bar").css("width",J.percent+"%");var U=g.find(".file-status").attr("title",ed.lang[bc]);U.find(".text").text(bc=="uploading"?J.percent+"%":bc=="failed"?ed.lang[bc]:"");if(b.fn.tooltip)g.find('[data-toggle="tooltip"]').tooltip("fixTitle");g.find("a.btn-download-file, a.file-name").attr("href",d)}if(Qc.previewImageIcon&&J.isImage){var bV=function(){g.find(".file-icon").html('<div class="file-icon-image" style="background-image: url('+J.previewImage+')"></div>')};if(J.previewImage){bV()}else{ed.previewImageSrc(J,function(b){J.previewImage=b;bV()})}}g.attr("data-status",bc).data("file",J)};U.prototype.showStatus=function(){var J=this;var Q=J.plupload;var ed=J.$status;var g=Q.state,Qc=Q.total,bc="",A=Q.files.length;if(J.options.statusCreator){bc=J.options.statusCreator(Qc,g,J)}else{var d={uploading:Math.max(0,Math.min(A,Qc.uploaded+1)),total:J.$list.children(".file-static").length+A,size:e.formatSize(Qc.size).toUpperCase(),queue:Qc.queued,failed:Qc.failed,uploaded:Qc.uploaded,uploadedSize:e.formatSize(Qc.loaded).toUpperCase(),percent:Qc.percent,speed:e.formatSize(Qc.bytesPerSec).toUpperCase()+"/S"};if(g==e.STARTED){bc=J.lang.startedStatusText.format(d)}else{if(A<1){bc=J.lang.initStatusText}else{bc=J.lang.stoppedStatusText.format(d)}}}ed.html(bc);if(Qc.uploaded<1)ed.find(".uploader-status-uploaded").remove();if(Qc.failed<1)ed.find(".uploader-status-failed").remove();if(Qc.queued<1)ed.find(".uploader-status-queue").remove();if(b.fn.tooltip)ed.find('[data-toggle="tooltip"]').tooltip()};U.prototype.delayShowStatus=function(b){var J=this;if(J.delayStatusTask)return;J.delayStatusTask=true;if(b===ed)b=500;J.delayStatusTask=setTimeout(function(){J.showStatus();J.delayStatusTask=false},b)};U.prototype.removeFile=function(J,e){var Q=this;if(typeof J=="string"){J=Q.plupload.getFile(J)}if(e||J.static){var ed=b("#file-"+J.id);if(b.fn.tooltip){ed.find('[data-toggle="tooltip"]').tooltip("destroy");b(".tooltip").remove()}ed.fadeOut(function(){b(this).remove()})}else{Q.plupload.removeFile(J)}};U.prototype.initPlupload=function(){var Q=this;var g=Q.options;var Qc=b.extend({},g,{browse_button:Q.$button[0],container:Q.$[0],drop_element:Q.$dropElement[0],multipart_params:null});var bc={FilesAdded:function(b,J){var e=g.limitFilesCount;if(e){if(e===true)e=1;var ed=Q.$list.children(".file").length;if(ed+J.length>e){Q.showMessage(Q.lang.limitFilesCountMessage.format({count:e}),"warning");var Qc=[];for(var bc=0;bc<J.length;++bc){if(ed+bc+1<=e){Qc.push(J[bc])}else{b.removeFile(J[bc])}}if(!Qc.length)return;J=Qc}}Q.showFile(J);if(g.autoUpload)Q.start();Q.showStatus();Q.callEvent("onFilesAdded",[J])},UploadProgress:function(b,J){Q.showFile(J);Q.delayShowStatus();Q.callEvent("onUploadProgress",J)},FileUploaded:function(J,Qc,bc){if(bc){var A=typeof bc==="object"?bc.response:bc;try{Qc.remoteData=b.parseJSON(A)}catch(b){}}if(Q.qiniuEnable&&Qc.remoteData){Qc.url=J.settings.domain+Qc.remoteData.key}var d=g.responseHandler;if(d){var U=null;if(b.isFunction(d)){U=d.call(Q,bc,Qc)}else if(bc.response){var bV=Qc.remoteData;if(b.isPlainObject(bV)){var bI=bV.status||bV.result;if(bI!==ed&&bI!=="ok"&&bI!=="success"&&bI!==200){U={message:bV.message,data:bV}}if(bV.id!==ed)Qc.remoteId=bV.id;if(bV.url!==ed)Qc.url=bV.url}}if(U){U=b.isPlainObject(U)?U:{message:U};Qc.status=e.FAILED;if(U.code===ed)U.code=e.GENERIC_ERROR;U.file=Qc;U.responseObject=bc;J.trigger("Error",U);return}}if(Qc.status===e.DONE){Q.lastUploadedCount++}Q.showFile(Qc,bc);Q.showStatus();Q.callEvent("onFileUploaded",[Qc,bc]);if(Qc.status===e.DONE){var a=g.removeUploaded;if(a){setTimeout(function(){b("#file-"+Qc.id).fadeOut(function(){b(this).remove()})},typeof a==="number"?a:2e3)}}},UploadComplete:function(J,ed){Q.showFile(ed);Q.showStatus();var Qc=g.uploadedMessage;if(Qc){var bc=Q.lastUploadedCount;var A=0;b.each(ed,function(b,J){if(J.status===e.FAILED)A++});var d="",U={uploaded:bc,failed:A};if(typeof Qc==="string"){d=Qc.format(U)}else if(b.isFunction(Qc)){d=Qc(U)}else{d=Q.lang[A>0?"uploadHasFailedMessage":bc>0?"uploadSuccessMessage":"uploadEmptyMessage"].format(U)}Q.showMessage(d,A>0?"danger":bc>0?"success":"warning",3)}Q.callEvent("onUploadComplete",[ed])},FilesRemoved:function(J,e){b.each(e,function(b,J){Q.removeFile(J,true)});Q.showStatus();Q.callEvent("onFilesRemoved",e)},ChunkUploaded:function(b,J,e){Q.callEvent("onChunkUploaded",[J,e])},UploadFile:function(b,J){Q.showStatus();Q.callEvent("onUploadFile",J)},BeforeUpload:function(J,e){var ed=g.multipart_params;var Qc={};if(g.sendFileName)Qc[g.sendFileName===true?"name":g.sendFileName]=e.name;if(g.sendFileId)Qc[g.sendFileId===true?"uuid":g.sendFileId]=e.id;Qc=b.extend(Qc,b.isFunction(ed)?ed(e,Qc):ed);J.setOption("multipart_params",Qc);Q.callEvent("onBeforeUpload",e)},Refresh:function(b){Q.showStatus();Q.callEvent("onRefresh")},StateChanged:function(b){if(b.state===e.STARTED){Q.lastUploadedCount=0}Q.$.toggleClass("uploader-started",e.STARTED===b.state);Q.hideMessage();Q.showStatus();Q.callEvent("onStateChanged",b.state)},QueueChanged:function(b){Q.showStatus();Q.callEvent("onQueueChanged")},Error:function(b,J){var ed="danger";if(J.code===e.FILE_SIZE_ERROR||J.code===e.FILE_SIZE_ERROR||J.code===e.FILE_EXTENSION_ERROR||J.code===e.FILE_DUPLICATE_ERROR||J.code===e.MAGE_FORMAT_ERROR)ed="warning";Q.showMessage(J.message,ed);Q.callEvent("onError",J)}};e.addI18n(Q.lang.i18n);Q.qiniuEnable=b.isPlainObject(g.qiniu)&&J.Qiniu;if(Q.qiniuEnable){var A=g.qiniu;var d=A.key;delete Qc.qiniu;if(d){delete A.key;if(b.isFunction(d)){bc.Key=d}}else{bc.Key=function(b,J){return J.name}}A.init=bc;Qc=b.extend(Qc,A);var U=new QiniuJsSDK;var bV=U.uploader(Qc);Q.plupload=bV}else{var bV=new e.Uploader(Qc);bV.init();Q.plOptions=Qc;Q.plupload=bV;b.each(bc,function(b,J){bV.bind(b,J)})}};U.prototype.getOptions=function(J){this.options=b.extend({lang:b.zui.clientLang()},bc,this.$.data(),J);return this.options};U.prototype.callEvent=function(J,e){var Q=this;if(!b.isArray(e))e=[e];Q.$.trigger(J,e);if(b.isFunction(Q.options[J])){return Q.options[J].apply(Q,e)}};b.fn.uploader=function(J,e){return this.each(function(){var Q=b(this);var ed=Q.data(g);var Qc=typeof J=="object"&&J;if(!ed)Q.data(g,ed=new U(this,Qc));if(typeof J=="string")ed[J](e)})};U.NAME=g;U.STATUS=A;U.ERRORS=d;U.NAME=g;U.LANG={zh_cn:{limitFilesCountMessage:"所有文件数目不能超过 {count} 个，如果要上传此文件请先从列表移除文件。",uploadEmptyMessage:"没有文件等待上传。",uploadSuccessMessage:"已上传 <strong>{uploaded}</strong> 个文件。",uploadHasFailedMessage:"已上传 <strong>{uploaded}</strong> 个文件，<strong>{failed}</strong> 个文件上传失败。",startedStatusText:'正在上传第 <strong>{uploading}</strong> 个文件，共 <strong title="总大小：{size}" data-toggle="tooltip" class="text-primary">{total}</strong> 个文件，<span class="uploader-status-uploaded">已上传 <strong title="总大小：{uploadedSize}" data-toggle="tooltip" class="text-primary">{uploaded}</strong> 个文件，</span><span class="uploader-status-failed"><strong>{failed}</strong> 个上传失败，</span>进度 <strong>{percent}%</strong>，平均速度 <strong>{speed}</strong>。',initStatusText:"添加文件或拖放文件来上传。",stoppedStatusText:'共 <strong title="总大小：{size}" data-toggle="tooltip" class="text-primary">{total}</strong> 个文件<span class="uploader-status-queue">，<strong>{queue}</strong> 个文件等待上传</span><span class="uploader-status-uploaded">，已上传 <strong title="总大小：{uploadedSize}" data-toggle="tooltip" class="text-primary">{uploaded}</strong> 个文件</span><span class="uploader-status-failed">，<strong>{failed}</strong> 个上传失败</span><span class="uploader-status-uploaded">，平均速度 <strong>{speed}</strong></span>。',deleteConfirm:"确定移除文件【{name}】？",download:"下载",rename:"重命名",repeat:"重新上传",remove:"移除",dropPlaceholder:"将文件拖放至在此处。",queue:"待上传",uploading:"正在上传",failed:"失败",done:"已上传",i18n:{"Stop Upload":"停止上传","Upload URL might be wrong or doesn't exist.":"上传的URL可能是错误的或不存在。",tb:"tb",Size:"大小",Close:"关闭","You must specify either browse_button or drop_element.":"您必须指定 browse_button 或者 drop_element。","Init error.":"初始化错误。","Add files to the upload queue and click the start button.":"将文件添加到上传队列，然后点击”开始上传“按钮。",List:"列表",Filename:"文件名","%s specified, but cannot be found.":"%s 已指定，但是没有找到。","Image format either wrong or not supported.":"图片格式错误或者不支持。",Status:"状态","HTTP Error.":"HTTP 错误。","Start Upload":"开始上传","Error: File too large:":"错误: 文件太大:",kb:"kb","Duplicate file error.":"无法添加重复文件。","File size error.":"文件大小错误。","N/A":"N/A",gb:"gb","Error: Invalid file extension:":"错误：无效的文件扩展名:","Select files":"选择文件","%s already present in the queue.":"%s 已经在当前队列里。","Resoultion out of boundaries! <b>%s</b> runtime supports images only up to %wx%hpx.":"超限。<b>%s</b> 支持最大 %wx%hpx 的图片。","File: %s":"文件: %s",b:"b","Uploaded %d/%d files":"已上传 %d/%d 个文件","Upload element accepts only %d file(s) at a time. Extra files were stripped.":"每次只接受同时上传 %d 个文件，多余的文件将会被删除。","%d files queued":"%d 个文件加入到队列","File: %s, size: %d, max file size: %d":"文件: %s, 大小: %d, 最大文件大小: %d",Thumbnails:"缩略图","Drag files here.":"把文件拖到这里。","Runtime ran out of available memory.":"运行时已消耗所有可用内存。","File count error.":"文件数量错误。","File extension error.":"文件扩展名错误。",mb:"mb","Add Files":"增加文件"}},zh_tw:{limitFilesCountMessage:"所有文件數目不能超過 {count} 個。",uploadEmptyMessage:"没有文件等待上傳。",uploadSuccessMessage:"已上傳 <strong>{uploaded}</strong> 个文件。",uploadHasFailedMessage:"文件上傳完成，已上傳 <strong>{uploaded}</strong> 個文件，<strong>{failed}</strong> 個文件上傳失败。",startedStatusText:'正在上傳第<strong>{uploading}</strong> 個文件，共<strong title="總大小：{size}" data-toggle="tooltip" class="text -primary">{total}</strong> 個文件，<span class="uploader-status-uploaded">已上傳<strong title="總大小：{uploadedSize}" data-toggle="tooltip" class="text-primary">{uploaded}</strong> 個文件，</span><span class="uploader-status-failed"><strong>{failed}</ strong> 個上傳失敗，</span>進度<strong>{percent}%</strong>，平均速度<strong>{speed}</strong>。',initStatusText:"添加文件或拖放文件來上傳。",stoppedStatusText:'共<strong title="總大小：{size}" data-toggle="tooltip" class="text-primary">{total}</strong> 個文件<span class="uploader-status-queue">，<strong>{queue}</strong> 個文件等待上傳</span><span class="uploader-status-uploaded">，已上傳<strong title="總大小：{uploadedSize}" data-toggle="tooltip" class="text-primary">{uploaded}</strong> 個文件</span><span class=" uploader-status-failed">，<strong>{failed}</strong> 個上傳失敗</span><span class="uploader-status-uploaded">，平均速度<strong>{speed}< /strong></span>。',deleteConfirm:"確定移除文件【{name}】？",download:"下载",rename:"重命名",repeat:"重新上傳",remove:"移除",dropPlaceholder:"將文件拖放至在此處。",queue:"待上傳",uploading:"正在上傳",failed:"失敗",done:"已上傳",i18n:{"Stop Upload":"停止上傳","Upload URL might be wrong or doesn't exist.":"檔案URL可能有誤或者不存在。",tb:"tb",Size:"大小",Close:"關閉","You must specify either browse_button or drop_element.":"您必須指定 browse_button 或 drop_element。","Init error.":"初始化錯誤。","Add files to the upload queue and click the start button.":"將檔案加入上傳序列，然後點選”開始上傳“按鈕。",List:"清單",Filename:"檔案名稱","%s specified, but cannot be found.":"找不到已選擇的 %s。","Image format either wrong or not supported.":"圖片格式錯誤或者不支援。",Status:"狀態","HTTP Error.":"HTTP 錯誤。","Start Upload":"開始上傳","Error: File too large:":"錯誤: 檔案大小太大:",kb:"kb","Duplicate file error.":"錯誤：檔案重複。","File size error.":"錯誤：檔案大小超過限制。","N/A":"N/A",gb:"gb","Error: Invalid file extension:":"錯誤：不接受的檔案格式:","Select files":"選擇檔案","%s already present in the queue.":"%s 已經存在目前的檔案序列。","Resoultion out of boundaries! <b>%s</b> runtime supports images only up to %wx%hpx.":"圖片解析度超出範圍！ <b>%s</b> 最高只支援到 %wx%hpx。","File: %s":"檔案: %s",b:"b","Uploaded %d/%d files":"已上傳 %d/%d 個文件","Upload element accepts only %d file(s) at a time. Extra files were stripped.":"每次只能上傳 %d 個檔案，超過限制數量的檔案將被忽略。","%d files queued":"%d 個檔案加入到序列","File: %s, size: %d, max file size: %d":"檔案: %s, 大小: %d, 檔案大小上限: %d",Thumbnails:"縮圖","Drag files here.":"把檔案拖曳到這裡。","Runtime ran out of available memory.":"執行時耗盡了所有可用的記憶體。","File count error.":"檔案數量錯誤。","File extension error.":"檔案副檔名錯誤。",mb:"mb","Add Files":"增加檔案"}},en:{limitFilesCountMessage:"All files count can not over {count}.",uploadEmptyMessage:"No file in queue to upload",uploadSuccessMessage:"Uploaded <strong>{uploaded}</strong> files。",uploadHasFailedMessage:"Uploaded complete, <strong>{uploaded}</strong> success, <strong>{failed}</strong> failed.",startedStatusText:'Uploading NO.<strong>{uploading}</strong> file, total <strong title="Total size: {size}" data-toggle="tooltip" class="text-primary">{total}</strong> files, <span class="uploader-status-uploaded">Uploaded <strong title="Total size: {uploadedSize}" data-toggle="tooltip" class="text-primary">{uploaded}</strong> files, </span><span class="uploader-status-failed"><strong>{failed}</strong> failed, </span>progress <strong>{percent}%</strong>, average spped <strong>{speed}</strong>。',initStatusText:"Append or drag file here.",stoppedStatusText:'Total <strong title="Total size: {size}" data-toggle="tooltip" class="text-primary">{total}</strong> files<span class="uploader-status-queue">, <strong>{queue}</strong> files in queue</span><span class="uploader-status-uploaded">, uploaded <strong title="Total size: {uploadedSize}" data-toggle="tooltip" class="text-primary">{uploaded}</strong> files</span><span class="uploader-status-failed">, <strong>{failed}</strong> failed</span><span class="uploader-status-uploaded">, average spped <strong>{speed}</strong></span>。',deleteConfirm:'Remove file "{name}" form upload queue?',rename:"Rename",download:"Download",repeat:"Repeat",remove:"Remove",dropPlaceholder:"Drop file here.",queue:"Wait",uploading:"Uploading",failed:"Failed",done:"Done",i18n:{"Stop Upload":"Stop Upload","Upload URL might be wrong or doesn't exist.":"Upload URL might be wrong or doesn't exist.",tb:"tb",Size:"Size",Close:"Close","You must specify either browse_button or drop_element.":"You must specify either browse_button or drop_element.","Init error.":"Init error.","Add files to the upload queue and click the start button.":"Add files to the upload queue and click the start button.",List:"List",Filename:"Filename","%s specified, but cannot be found.":"%s specified, but cannot be found.","Image format either wrong or not supported.":"Image format either wrong or not supported.",Status:"Status","HTTP Error.":"HTTP Error.","Start Upload":"Start Upload","Error: File too large:":"Error: File too large:",kb:"kb","Duplicate file error.":"Duplicate file error.","File size error.":"File size error.","N/A":"N/A",gb:"gb","Error: Invalid file extension:":"Error: Invalid file extension:","Select files":"Select files","%s already present in the queue.":"%s already present in the queue.","Resoultion out of boundaries! <b>%s</b> runtime supports images only up to %wx%hpx.":"Resoultion out of boundaries! <b>%s</b> runtime supports images only up to %wx%hpx.","File: %s":"File: %s",b:"b","Uploaded %d/%d files":"Uploaded %d/%d files","Upload element accepts only %d file(s) at a time. Extra files were stripped.":"Upload element accepts only %d file(s) at a time. Extra files were stripped.","%d files queued":"%d files queued","File: %s, size: %d, max file size: %d":"File: %s, size: %d, max file size: %d",Thumbnails:"Thumbnails","Drag files here.":"Drag files here.","Runtime ran out of available memory.":"Runtime ran out of available memory.","File count error.":"File count error.","File extension error.":"File extension error.",mb:"mb","Add Files":"Add Files"}}};b.zui.plupload=e;b.zui.moxie=Q;b.zui.Uploader=U;b.fn.uploader.Constructor=U;if(!J.mOxie)J.mOxie={Env:Q.core.utils.Env,XMLHttpRequest:Q.xhr.XMLHttpRequest};b(function(){b('[data-ride="uploader"]').uploader()})})(jQuery,window,plupload,moxie,undefined);